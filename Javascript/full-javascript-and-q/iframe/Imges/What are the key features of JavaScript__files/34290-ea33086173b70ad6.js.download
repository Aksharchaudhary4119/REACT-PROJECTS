"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34290],{38389:function(a,b,c){c.d(b,{e:function(){return e}});var d=c(10308),e=function(a,b,c){var e="/api/cloud-course-session/".concat(a,"/").concat(b,"/").concat(c);return(0,d.Z)({url:e,type:"POST"})}},76395:function(a,b,c){c.d(b,{"$X":function(){return ad},"$_":function(){return U},"$q":function(){return a2},Ac:function(){return aB},Am:function(){return bG},Az:function(){return aU},BH:function(){return aP},BM:function(){return aC},Bl:function(){return _},CH:function(){return bN},CI:function(){return W},D1:function(){return an},De:function(){return aT},E7:function(){return ay},EX:function(){return bp},Fv:function(){return aS},GW:function(){return $},Gi:function(){return aZ},Ho:function(){return aD},Hu:function(){return aL},Hv:function(){return bc},IT:function(){return bm},JF:function(){return a7},JX:function(){return S},Jn:function(){return bL},Jw:function(){return aF},KU:function(){return aw},MC:function(){return al},Mj:function(){return bj},Og:function(){return bt},Ol:function(){return aA},Ox:function(){return bk},P4:function(){return ax},Pt:function(){return a6},Pw:function(){return aa},QL:function(){return aG},S3:function(){return R},Se:function(){return bo},Sr:function(){return T},T0:function(){return bg},T9:function(){return bh},TZ:function(){return bb},Ts:function(){return bf},UY:function(){return bl},Uy:function(){return bz},VA:function(){return aH},Xe:function(){return bn},YS:function(){return bK},Z:function(){return bu},Z4:function(){return X},Z9:function(){return aV},ZW:function(){return aJ},Zj:function(){return a4},"_N":function(){return at},"_Q":function(){return br},"_k":function(){return a8},aB:function(){return a$},a_:function(){return aO},bH:function(){return bE},cA:function(){return am},cH:function(){return bq},dL:function(){return aj},dP:function(){return bM},dp:function(){return ar},dz:function(){return bs},f4:function(){return bx},fE:function(){return bH},fo:function(){return as},gA:function(){return aR},gx:function(){return au},ih:function(){return ak},ix:function(){return ac},jK:function(){return bi},kF:function(){return a9},kU:function(){return a3},l0:function(){return bF},l3:function(){return Q},l6:function(){return az},mI:function(){return aN},mK:function(){return aX},m_:function(){return bD},ms:function(){return ba},mx:function(){return bI},"n$":function(){return bA},nu:function(){return bv},oD:function(){return ag},oJ:function(){return aI},oQ:function(){return V},oW:function(){return bJ},oe:function(){return a5},oj:function(){return aK},p2:function(){return aW},pK:function(){return ah},pM:function(){return by},qA:function(){return ai},qI:function(){return aM},rr:function(){return bd},tn:function(){return be},uH:function(){return Y},uy:function(){return aY},v2:function(){return bC},vD:function(){return af},wk:function(){return bO},x3:function(){return a1},xf:function(){return aE},xn:function(){return bB},yF:function(){return bw},yQ:function(){return ab},yu:function(){return ae},z_:function(){return Z}});var d=c(54551),e=c.n(d),f=c(31082),g=c(81094),h=c(27250),i=c(66985),j=c(21387),k=c(10308),l=c(40028),m=c(40643),n=c(84119),o=c(67481),p=c(71653),q=c(16560),r=c(30797),s=c(34290),t=c(31653),u=c(22989),v=c(62171),w=c(34469),x=c(10907),y=c(43521),z=c(88674),A=c(28399),B=c(10642),C=c(62368),D=c(31414);function E(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function F(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function G(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){F(f,d,e,g,h,"next",a)}function h(a){F(f,d,e,g,h,"throw",a)}g(void 0)})}}function H(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function I(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){H(a,b,c[b])})}return a}function J(a,b){return b=null!=b?b:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):(function(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);c.push.apply(c,d)}return c})(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))}),a}function K(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(a,b){var c,d,e=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=e){var f=[],g=!0,h=!1;try{for(e=e.call(a);!(g=(c=e.next()).done)&&(f.push(c.value),!b||f.length!==b);g=!0);}catch(i){h=!0,d=i}finally{try{g||null==e.return||e.return()}finally{if(h)throw d}}return f}}(a,b)||M(a,b)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(a){return function(a){if(Array.isArray(a))return E(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||M(a)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(a,b){if(a){if("string"==typeof a)return E(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return E(a,b)}}var N,O,P=function(a){return a===p.dLO.PLAN?"Path":(0,p.eiC)(a)},Q=function(a,b){return function(c){b.reset(),c(w.R.reset()),a({isLoading:!1,isLoaded:!1,isError:!1})}},R=function(a){var b=a.pathAuthorId,c=a.pathId,d=a.categoryId,e=a.orgId,f=a.index;return(0,k.Z)({url:"/api/enterprise/".concat(b,"/").concat(c,"/").concat(e,"/connect"),type:"POST",data:{week_id:d,index:f}})},S=function(a,b,c,d){return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/collaborators?considerSelf=").concat(c,"&status=").concat(d),type:"GET"})},T=function(a,b,c,d,e,f){var g=arguments.length>6&& void 0!==arguments[6]&&arguments[6];return(0,k.Z)({url:"/api/author/collection/create-cloned",type:"POST",data:{author_id:a,work_id:b,url_slug:c,path_author_id:d,path_id:e,organization_id:f,enable_collaborative_editor:g}})},U=function(a,b,c,d,e){return(0,k.Z)({url:"/api/author/".concat(d,"/work/").concat(e,"/lessons/create-cloned"),type:"POST",data:{author_id:a,work_id:b,url_slug:c,path_author_id:d,path_id:e}})},V=function(a,b,c,d){var e="/api/author/".concat(a,"/collection/").concat(b,"/deleted-pages");return c&&(e+="?cursor=".concat(c)),d&&(e+="?pageSize=".concat(d)),(0,k.Z)({url:e,type:"GET"})},W=function(a,b,c){var d="/api/author/".concat(a,"/collection/").concat(b,"/deleted-document?document_type=").concat(c);return(0,k.Z)({url:d,type:"GET"})},X=function(a){var b,c=a.author_id,d=a.collection_id,e=a.course_url_slug,f=a.work_type;return b=e?"collection/".concat(e,"/certificate-status?work_type=").concat(f):"collection/".concat(c,"/").concat(d,"/certificate-status?work_type=").concat(f),(0,k.Z)({url:"/api/".concat(b),type:"GET"})},Y=function(a){var b=a.organizationId,c=a.authorId,d=a.workId,e=a.isPlan,f=a.fetchCount;return(0,k.Z)({url:"/api/enterprise/".concat(b,"/").concat(c,"/").concat(d,"/activity-stats?page_size=").concat(p.ZZN).concat(void 0!==e&&e?"&is_plan=true":"").concat(void 0!==f&&f?"&fetch_count=true":""),type:"GET"})},Z=function(a){var b=a.organizationId,c=a.authorId,d=a.workId,e=a.usersList,f=a.workDetail,g=a.isPlan;return(0,k.Z)({url:"/api/enterprise/".concat(b,"/").concat(c,"/").concat(d,"/activity-stats").concat(void 0!==g&&g?"?is_plan=true":""),type:"POST",data:{user_ids_list:JSON.stringify(e),work_detail:JSON.stringify({data:f})}})},$=function(a){return(0,k.Z)({url:"/api/reader/assessments/organization/".concat(a),type:"GET"})},_=function(){return(0,k.Z)({url:"/api/reader/enterprise/assigned-assessments",type:"GET"})},aa=function(a){return(0,k.Z)({url:"/api/enterprise/organization/".concat(a,"/assessments"),type:"GET"})},ab=function(){return(0,k.Z)({url:"/api/reader/enterprise/assigned-projects",type:"GET"})},ac=function(a,b){return(0,k.Z)({url:"/api/user-learning-plans?type=".concat(a).concat(b?"&return_questionnaire_only=true":""),type:"GET"})},ad=function(a,b){return(0,k.Z)({url:"/api/learning-plan/".concat(a,"/").concat(b,"/assign"),type:"POST"})},ae=function(a,b,c,d,e,f){return(0,k.Z)({url:"/api/user/onboarding-preferences",type:"POST",data:{purpose_of_learning:a,experience:b,area_of_interest_id:c,topics_or_language_of_interest:d,proficiency_in_area_of_interest:e,user_onboarding_recommendations:f}})},af=function(){return(0,k.Z)({url:"/api/user/onboarding-recommendations",type:"GET"})},ag=function(){return(0,k.Z)({url:"/api/editorial/user-onboarding/area-of-interest",type:"GET"})},ah=function(a){return(0,k.Z)({url:"/api/editorial/user-onboarding/skill?area_of_interest_id=".concat(a),type:"GET"})},ai=function(){return(0,k.Z)({url:"/api/user/flag/onboarding-questionnaire",type:"PUT"})},aj=function(){return(0,k.Z)({url:"/api/user/flag/weekly-goals-tour",type:"PUT"})},ak=function(){return arguments.length>0&& void 0!==arguments[0]&&arguments[0],(0,k.Z)({url:"/api/user/flag/customize-fonts",type:"PUT"})},al=function(){return arguments.length>0&& void 0!==arguments[0]&&arguments[0],(0,k.Z)({url:"/api/user/flag/used-customize-fonts",type:"PUT"})},am=function(){return arguments.length>0&& void 0!==arguments[0]&&arguments[0],(0,k.Z)({url:"/api/user/flag/customize-fonts-feedback",type:"PUT"})},an=function(a){var b,c=a.author_id,d=a.collection_id,e=a.course_url_slug,f=void 0===e?"":e,g=a.is_draft_page,h=a.work_type,i=a.path_author_id,j=void 0===i?null:i,l=a.path_id,m=void 0===l?null:l,n=a.isModulePreview,o=a.cloudCourseTestMode,p=a.backendProxyUrl,q=a.cookies,r=void 0===q?"":q;return b=f?"collection/".concat(f,"?work_type=").concat(h):void 0!==g&&g&&!(void 0!==n&&n)?"author/".concat(c,"/collection/").concat(d,"?work_type=").concat(h).concat(j&&m?"&path_author_id=".concat(j,"&path_id=").concat(m):"").concat(void 0!==o&&o?"&test_lab=true":""):"collection/".concat(c,"/").concat(d,"?work_type=").concat(h).concat(j&&m?"&path_author_id=".concat(j,"&path_id=").concat(m):""),(0,k.Z)(I({url:"".concat(void 0===p?"":p,"/api/").concat(b),type:"GET"},r&&{headers:{cookie:r}}),!0)},ao=(0,f.ZP)(function(a,b){var c,d,e,f=null==a?void 0:null===(c=a.instance)|| void 0===c?void 0:null===(d=c.details)|| void 0===d?void 0:d.docker;f?((0,t.w)(f),f.envs=null!==(e=f.envs)&& void 0!==e?e:[],f.container.liveInstance=b):a.instance.details.docker=x.s4}),ap=(0,f.ZP)(function(a){var b,c,d,e=null==a?void 0:null===(b=a.instance)|| void 0===b?void 0:null===(c=b.details)|| void 0===c?void 0:c.toc;null==e||null===(d=e.categories)|| void 0===d||d.forEach(function(a){a.id!==n.s||a.title||(a.title="Recovered Lessons")})}),aq=(0,f.ZP)(function(a,b){var c,d=null==a?void 0:a.docker;d?((0,t.w)(d),d.envs=null!==(c=d.envs)&& void 0!==c?c:[],d.container.liveInstance=b):a.docker=x.s4}),ar=function(a,b,d,f){var g,h=arguments.length>4&& void 0!==arguments[4]&&arguments[4],i=!(arguments.length>5)|| void 0===arguments[5]||arguments[5];return g=G(e().mark(function g(j){var k,l,m,n,p,q;return e().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l=c.g.loaderContext.stateLoader,m=!!(null===(k=d.data)|| void 0===k?void 0:k.user_id)||(null==a?void 0:a.is_user_loggedin)||b,!(i&&(m||a.instance.details.allow_logged_out_executions))){e.next=9;break}return e.next=6,(0,y.wi)(a.collectionId,a.authorId);case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0={};case 10:if(p=ao(a,n=e.t0),p=ap(p),!(q=!(h||l.isLoading))){e.next=16;break}throw Error(o.pX.programmaticallyCancelled);case 16:return f.set(p),e.abrupt("return",j(u.ry.setObject(p.instance.details.docker)));case 18:case"end":return e.stop()}},g)})),function(a){return g.apply(this,arguments)}},as=function(a,b,c){var d;return d=G(e().mark(function d(f){var g,h,i,j;return e().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(g=a.author_id,h=a.collection_id,!b){d.next=7;break}return d.next=4,(0,y.wi)(h,g);case 4:d.t0=d.sent,d.next=8;break;case 7:d.t0={};case 8:return j=aq(a,i=d.t0),d.next=12,c.updateDockerForExternalLesson(j);case 12:return d.abrupt("return",f(u.ry.setObject(j.docker)));case 13:case"end":return d.stop()}},d)})),function(a){return d.apply(this,arguments)}},at=function(a){var b=a.userInfoState,c=a.params,d=a.router,f=a.collectionActions,h=a.ignoreLoadingState,i=void 0!==h&&h,j=a.disableAllRedirections,k=void 0!==j&&j,l=a.isModulePreview,m=void 0!==l&&l,n=a.rethrowError,r=void 0!==n&&n,t=a.setLoaderStateDispatch,u=void 0===t?function(a){}:t,w=a.setNotFound,x=void 0===w?function(a){}:w;return function(a){var h,j,l,n=null==d?void 0:null===(h=d.query)|| void 0===h?void 0:h.test_lab;u({isLoading:!0,isLoaded:!1});var t=(null==d?void 0:null===(j=d.query)|| void 0===j?void 0:j.work_type)||(0,C.Z)(null==d?void 0:d.asPath),w=null==d?void 0:d.asPath.includes("/plan/"),y=new g.Z,E=y.decode(null==d?void 0:null===(l=d.query)|| void 0===l?void 0:l.encodedPathInfo);c.work_type||(c=J(I({},c),{work_type:t}));var F,H=/(collection|path|module)editor\/([0-9]{1,16})\/([0-9]{1,16})$/;return an(J(I({},c),{isModulePreview:m,cloudCourseTestMode:n})).then((F=G(e().mark(function g(h){var j,l,n,o,q,r,u,v,w,x,A,C,D,F,G;return e().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=(r=null==(q=JSON.parse(o=h.data))?void 0:null===(j=q.instance)|| void 0===j?void 0:j.details).work_type,v=r.author_id,w=r.collection_id,x=r.collection_type,t!==u&&c.is_draft_page&&H.test(null==d?void 0:d.asPath)&&!k&&d.replace("/".concat(u,"editor/").concat(v,"/").concat(w)),q=J(I({},q),{collectionId:w,authorId:v}),c.author_id&&!c.course_url_slug&&r.url_slug&&!(c.is_draft_page||m)&&((0,z.qP)(z.f2.REDIRECTION,z.bt.FRIENDLY_URL_REDIRECTION),(A=[p.dLO.SKILL_ASSESSMENT,p.dLO.STANDALONE_PROJECT,p.dLO.STANDALONE_CLOUD_LAB,].includes(x))&&!E?C="/".concat(p.J0o[x],"/").concat(r.url_slug):!A&&(D=(0,B.Z)(t,!!c.page_id),C="/".concat(D,"/").concat(r.url_slug),c.page_id&&(C+="/".concat("courses"===D&&d.query.page_url_slug?d.query.page_url_slug:y.encode(parseInt(c.page_id,10)))),d.asPath.split("#")[0].endsWith("/assessment")&&(C+="/assessment"),d.asPath.endsWith("/project")&&(C+="/project"),d.asPath.endsWith("/cloudlab")&&(C+="/cloudlab"),d.asPath.split("#")[0].endsWith("/certificate")&&(C+="/certificate"),d.asPath.split("#")[1]&&(C+="#".concat(d.asPath.split("#")[1]))),!k&&C&&d.replace(C)),F=/^\/(((courses|path)\/[a-zA-Z0-9-_]+)|((collection|path|(module\/[a-zA-Z0-9-_]+))(\/[0-9]{1,16}){0,2}))$/,G=(null==c?void 0:c.skipLiveInstanceFetch)||F.test(null==d?void 0:d.asPath),e.next=15,a(ar(q,null==c?void 0:c.is_draft_page,b,f,i,!G));case 15:return(null==q?void 0:null===(l=q.instance)|| void 0===l?void 0:null===(n=l.details)|| void 0===n?void 0:n.user_course_cloud_lab)&&(0,s.setCredentialAsApiKeysAndEnvKeys)(a,q,q.instance.details.user_course_cloud_lab,q.instance.details.course_cloud_lab.active_group_id,q.instance.details.course_cloud_lab.active_page_id),e.abrupt("return",q);case 17:case"end":return e.stop()}},g)})),function(a){return F.apply(this,arguments)})).then(function(){return u({isLoaded:!0,isLoading:!1})}).catch(function(b){if(b.message===o.pX.failedToFetch){(0,D.uX)(b);return}if(b.toString()!==o.pX.requestAborted){if(b.message!==o.pX.programmaticallyCancelled&&(0,A.rU)(b,a,void 0,void 0,w),403===b.status)x({notFoundPageStatus:!0}),u({isLoaded:!0,isLoading:!1});else{var c,d;c=b,(null!=(d=Response)&&"undefined"!=typeof Symbol&&d[Symbol.hasInstance]?!!d[Symbol.hasInstance](c):c instanceof d)&&401!==b.status&&(u({isLoaded:!1,isLoading:!1,isError:!0}),a(v.n.show(q.ad,{status:"ERROR",text:(0,A.nU)(b)||"Unable to load Collection"})))}if(r)throw b}})}},au=function(a,b){var c=arguments.length>2&& void 0!==arguments[2]?arguments[2]:{},d=arguments.length>3?arguments[3]:void 0,e=arguments.length>4&& void 0!==arguments[4]&&arguments[4];return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b),type:"PUT",data:c,headers:H({},r.Zq,d)},!0,e)},av=function(a,b,d){var e=arguments.length>3&& void 0!==arguments[3]?arguments[3]:p.dLO.COLLECTION,f=arguments.length>4&& void 0!==arguments[4]&&arguments[4],g=arguments.length>5&& void 0!==arguments[5]&&arguments[5];return function(h){var i=c.g.loaderContext.loaderActions.set;return i({isLoading:!0}),h(v.n.show(g?q.lu:q.ad,{status:p.oiP.WAIT,text:"Saving"})),au(a.author_id,a.collection_id,a.payload,a.payload.eTag,f).then(function(c){var e=c.xhr,f=a.payload,g=(null==c?void 0:c.data)?JSON.parse(c.data):{};b.updateETAG(e.headers.get(r.Zq)),h(v.n.update({status:p.oiP.SUCCESS,text:"Saved"})),b.updateDetails(I({},f,g)),b.setPagesRecovered(!1),"function"==typeof d&&d(),i({isLoaded:!0,isLoading:!1}),b.setDirty(!1)}).catch(function(c){(0,A.rU)(c,h),c.status===o.Wy.AlreadyExistsException?(h(v.n.close()),a.payload.eTag=p.FhE,h(v.n.show(q.zN,{onConfirm:function(){return h(av(a,b,void 0,e,!1,g))},cancelText:"Cancel",confirmText:"Save",title:"Conflicts",description:"The content you are editing has changed. The previous changes will be overwritten. Are you sure you want to save?"}))):h(v.n.update({status:p.oiP.ERROR,text:(0,A.nU)(c)||"Unable to Save Changes"})),i({isLoading:!1})})}},aw=function(a,b){var c=arguments.length>2&& void 0!==arguments[2]?arguments[2]:"collection",d=arguments.length>3?arguments[3]:void 0,e=arguments.length>4&& void 0!==arguments[4]?arguments[4]:null;return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/publish?work_type=").concat(c).concat(e===p.dLO.QUESTIONNAIRE?"&course_type=questionnaire":""),type:"POST",data:{path_id:d}})},ax=function(a,b){var c=arguments.length>2&& void 0!==arguments[2]?arguments[2]:p.dLO.COLLECTION;return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"?work_type=").concat(c),type:"DELETE"})},ay=function(a,b){var c=arguments.length>2&& void 0!==arguments[2]&&arguments[2],d=arguments.length>3&& void 0!==arguments[3]?arguments[3]:p.dLO.COLLECTION,e=arguments.length>4&& void 0!==arguments[4]?arguments[4]:function(){},f=arguments.length>5?arguments[5]:void 0;return function(g){return g(v.n.show(q.ad,{status:"WAIT",text:"Deleting"})),ax(a,b).then(JSON.parse).then(function(a){a.is_submitted?g(v.n.update({status:"ERROR",text:"".concat(P(d)," already submitted for deletion")})):a.is_approved&&!a.is_submitted?(g(v.n.update({status:"SUCCESS",text:"".concat(P(d)," submitted for deletion")})),c&&(null==f||f.load())):(g(v.n.update({status:"SUCCESS",text:"Deleted"})),null==f||f.deleteWork(b),e())}).catch(function(a){console.log(a),(0,A.rU)(a,g),d===p.dLO.ENTERPRISE_ASSESSMENT&&(0,z.qP)(z.f2.ENTERPRISE_ASSESSMENTS,z.bt.UNEXPECTED_ERROR_ASSESSMENT),g(v.n.update({status:"ERROR",text:"Unable to Delete ".concat((0,p.eiC)(d))}))})}},az=function(a,b,d,e,f,g,h){var i=arguments.length>7&& void 0!==arguments[7]?arguments[7]:null,j=arguments.length>8&& void 0!==arguments[8]&&arguments[8],k=!(arguments.length>9)|| void 0===arguments[9]||arguments[9],m=arguments.length>10&& void 0!==arguments[10]?arguments[10]:null,n=arguments.length>11&& void 0!==arguments[11]&&arguments[11];return function(o){return h({isLoading:!0}),o(v.n.showOrUpdate(n?q.lu:q.ad,{status:p.oiP.WAIT,text:e})),aw(a,b,d,i,m).then(function(){k&&c.g.authorCollectionActions.publish(),o(v.n.show(n?q.lu:q.ad,I({status:p.oiP.SUCCESS,text:f},n?{icon:l.Z,actionButtonText:"View",actionButtonClickHandler:function(){return"function"==typeof g&&g()}}:{}))),n||"function"!=typeof g||g(),h({isLoading:!1})}).catch(function(a){if((0,A.rU)(a,o),o(v.n.showOrUpdate(n?q.lu:q.ad,{status:p.oiP.ERROR,text:(0,A.nU)(a)||"".concat(e," failed")})),h({isLoading:!1}),j)throw a})}},aA=function(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]&&arguments[3],e="/api/editorial/approve/".concat(a,"/").concat(b,"?work_type=").concat(c).concat(d?"&is_private=true":"");return(0,k.Z)({url:e,type:"PUT"})},aB=function(a,b,c){var d="/api/author/".concat(a,"/collection/").concat(b,"/containers/").concat(c,"/get_upload_url");return(0,k.Z)({url:d,type:"GET"}).then(JSON.parse)},aC=function(a,b,c,d){return function(e){var f=c.file.name.split(" ").join("-"),g="/api/author/".concat(a,"/collection/").concat(b,"/containers/").concat(f,"/get_upload_url");return d({isLoaded:!1,isLoading:!0}),(0,k.Z)({url:g,type:"GET"}).then(JSON.parse).then(function(a){var b=a.gcs_object_name,g=a.container_id,h=a.blob_upload_url,i=a.upload_success_url,j=a.build_status_url,l=a.tarball_download_url,m=a.build_log_url,n=a.rebuild_image_url;return e(u.ry.setFile(J(I({},c),{id:void 0===g?-1:g,buildStatusUrl:j,tarballDownloadUrl:l,buildLogUrl:m,rebuildImageUrl:n,file:{name:f,size:c.file.size,awaitingUpload:!0}}))),d({isLoaded:!0,isLoading:!1}),{onUploadSuccess:function(){return(0,k.Z)({url:i,type:"POST",data:{gcs_object_name:b}},!0)},upload:function(){return(0,k.Z)({url:h,type:"POST",data:c.file,processData:!1,contentType:c.file.type})}}}).catch(function(a){console.log(a),e(v.n.show(q.ad,{status:"ERROR",text:"Setting Docker File failed"})),d({isLoaded:!1,isLoading:!1})})}},aD=function(a){var b=a.authorId,c=a.collectionId,d=a.upload,e=a.onUploadSuccess,f=a.collectionType,g=a.showToastModal,h=void 0!==g&&g;return function(a){return a(u.ry.updateBuildStatus("UPLOADING")),d().then(function(){return e()}).then(function(a){return JSON.parse(a.data)}).then(function(d){var e=d.image_name;a(ba({author_id:b,collection_id:c},u.ry.afterFileUpload(void 0===e?"default_name":e),!1,f)),a(v.n.show(h?q.lu:q.ad,{status:p.oiP.SUCCESS,text:"Docker Image build has been queued!!"}))}).catch(function(g){if(500===g.status){a(aD({authorId:b,collectionId:c,upload:d,onUploadSuccess:e,collectionType:f,showToastModal:h}));return}console.log("error while uploading docker file",g),a(u.ry.updateBuildStatus("FAILURE")),a(v.n.show(h?q.lu:q.ad,{status:p.oiP.ERROR,text:"Uploading Docker File failed"}))})}},aE=function(a,b,c){return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/cerf/").concat(c,"/upload/url"),type:"GET"})},aF=function(a,b,c,d,e){var f="";return f=e?"/api/edpresso/shot/".concat(e,"/cerf/").concat(c,"/upload/url?content_type=").concat(m.qL,"&author_id=").concat(a):"/api/author/".concat(a,"/collection/").concat(b,"/cerf/").concat(c,"/upload/url?content_type=").concat(m.qL,"&page_id=").concat(d),(0,k.Z)({url:f,type:"GET"})},aG=function(a,b,c,d,e){var f=!(arguments.length>5)|| void 0===arguments[5]||arguments[5],g="";return g=b?"/api/edpresso/shot/".concat(b,"/cerf/").concat(d,"/download?return_signed_url=true"):"/api/".concat(f?"author":"collection","/").concat(a,"/collection/").concat(c,"/cerf/").concat(d,"/download?return_signed_url=true&page_id=").concat(e),(0,k.Z)({url:g,type:"GET"})},aH=(N=G(e().mark(function a(b,c,d,f){var g,h,i,j,l,n,o=arguments;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return g=o.length>4&& void 0!==o[4]&&o[4],h=b.upload_url,i=b.upload_success_url,j=b.gcs_object_name,l=function(){return(0,k.Z)({url:h,type:"POST",data:c.file,processData:!1,contentType:c.type})},n=function(){return(0,k.Z)({url:i+"?content_type=".concat(m.qL,"&page_id=").concat(d).concat(g?"&author_id=".concat(f):""),type:"POST",data:{gcs_object_name:j,file_size:c.size}})},a.next=6,l();case 6:return a.next=8,n();case 8:case"end":return a.stop()}},a)})),function(a,b,c,d){return N.apply(this,arguments)}),aI=(O=G(e().mark(function a(b,c,d,f){var g,h,i,j,l,m,n,o=arguments;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return g=o.length>4&& void 0!==o[4]&&o[4],h=c.upload_url,i=c.upload_success_url,j=c.gcs_object_name,l=function(){return(0,k.Z)({url:h,type:"POST",data:d,processData:!1,contentType:d.type})},m=function(){return(0,k.Z)({url:i,type:"POST",data:{gcs_object_name:j,file_size:d.size}})},b(v.n.show(g?q.lu:q.ad,{status:p.oiP.WAIT,text:"Uploading code resource file"})),n=I({},c),a.next=8,l();case 8:return a.next=10,m();case 10:n.file=null,n.upload_url=null,n.upload_success_url=null,n.updated=!1,n.uploadStatus=p.TEe.UPLOAD_SUCCESSFUL,f.updateCodeExecResourceFile(n);case 16:case"end":return a.stop()}},a)})),function(a,b,c,d){return O.apply(this,arguments)}),aJ=function(a,b){return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/udata/upload/url"),type:"GET"})},aK=function(a,b){var c=arguments.length>2&& void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3&& void 0!==arguments[3]&&arguments[3];return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/page?work_type=").concat(c||(0,C.Z)(),"&claim=").concat(d),type:"POST"})},aL=function(a,b){var c=arguments.length>2&& void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3?arguments[3]:void 0;return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/page_with_content?work_type=").concat(c||(0,C.Z)()),type:"POST",data:{article_data:JSON.stringify(d)}})},aM=function(a,b){var c=arguments.length>2&& void 0!==arguments[2]?arguments[2]:p.dLO.COLLECTION,d=arguments.length>3&& void 0!==arguments[3]&&arguments[3];return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/project?work_type=").concat(c,"&claim=").concat(d),type:"POST"})},aN=function(a,b){var c=arguments.length>2&& void 0!==arguments[2]?arguments[2]:p.dLO.COLLECTION,d=arguments.length>3&& void 0!==arguments[3]&&arguments[3];return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/assessment?work_type=").concat(c,"&claim=").concat(d),type:"POST"})},aO=function(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]?arguments[3]:null,e=arguments.length>4&& void 0!==arguments[4]?arguments[4]:null,f=arguments.length>5&& void 0!==arguments[5]?arguments[5]:null,g=arguments.length>6&& void 0!==arguments[6]?arguments[6]:null,h=arguments.length>7&& void 0!==arguments[7]?arguments[7]:null;return(0,k.Z)({url:"/api/author/clone/".concat(a,"/collection/").concat(b,"/assessment?work_type=").concat((0,C.Z)()),type:"POST",data:{author_id:d,collection_id:e,page_id:f,work_type:c,url_slug:g,page_url_slug:h}})},aP=function(a,b,c){return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/project/").concat(c,"/project_component"),type:"POST"})},aQ=function(a,b,c,d){var e=arguments.length>4&& void 0!==arguments[4]?arguments[4]:"";return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/assessment/").concat(c,"/question").concat(d===p.Q5R.QUESTIONNAIRE?"?assessment_type=questionnaire":e?"?question_type=".concat(e):""),type:"POST"})},aR=function(a,b){var c=arguments.length>2&& void 0!==arguments[2]&&arguments[2],d=arguments.length>3&& void 0!==arguments[3]&&arguments[3];return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/cloud-lab?claim=").concat(c,"&cloud_course=").concat(d),type:"POST"})},aS=function(a,b){return(0,k.Z)({url:"/api/author/clone/learning-plans/questionnaire/".concat(a,"/").concat(b),type:"POST"})},aT=function(a,b){return(0,k.Z)({url:"/api/author/clone/learning-plans/questionnaire/".concat(a,"/").concat(b),type:"GET"})},aU=function(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]?arguments[3]:null,e=arguments.length>4&& void 0!==arguments[4]?arguments[4]:null,f=arguments.length>5&& void 0!==arguments[5]?arguments[5]:null,g=arguments.length>6&& void 0!==arguments[6]?arguments[6]:null,h=arguments.length>7&& void 0!==arguments[7]?arguments[7]:null;return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/page?work_type=").concat((0,C.Z)()),type:"POST",data:{author_id:d||a,collection_id:e||b,page_id:c,work_type:f||p.dLO.COLLECTION,url_slug:g,page_url_slug:h}})},aV=function(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]?arguments[3]:p.dLO.COLLECTION;return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/page/").concat(c,"/recover?work_type=").concat(d),type:"POST"})},aW=function(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]?arguments[3]:p.dLO.COLLECTION;return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/page/").concat(c,"/mark-as-hard-deleted?work_type=").concat(d),type:"POST"})},aX=function(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]?arguments[3]:p.dLO.COLLECTION;return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/page/").concat(c,"?work_type=").concat(d),type:"DELETE"})},aY=function(a,b,c){return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/collection-or-page-title"),type:"POST",data:c})},aZ=function(a,b,c,d){return(0,k.Z)({url:"/api/reader/external-offer",type:"POST",data:{author_id:a,collection_id:b,page_id:c,course_completion_percentage:d}})},a$=function(a,b,c,d,e){return(0,k.Z)({url:"/api/reader/external-offer/interaction/".concat(a),type:"POST",data:{author_id:c,collection_id:d,interaction:b,course_completion_percentage:e}})};function a_(a,b){var c,d,e=JSON.stringify(a.instance.details.toc),f=I({},a.instance.details),g=null!==(d=null===(c=f.code_exec_resource_metadata)|| void 0===c?void 0:c.file_id)&& void 0!==d?d:null,h=JSON.stringify(f.udata_files.map(function(a){return a.file_id})),i=JSON.stringify({code_themes:f.CodeThemes}),j=f.collaborators||[],k=JSON.stringify(Object.values(j).map(function(a){return a.author_id})),l=JSON.stringify(f.testimonials),m=JSON.stringify((0,x.qZ)(b)),n=a[r.Zq],o=JSON.stringify({licensing:f.licensing}),p=f.tags.toString(),q=JSON.stringify({api_keys:f.api_keys});delete f.api_keys,delete f.toc,delete f.udata_files,delete f.CodeThemes,delete f.testimonials,delete f.licensing;var s=J(I({},f),{categories_json_string:e,testimonials_string:l,docker:m,user_data_file_ids_string:h,code_exec_resource_file_id:g,default_themes_json_string:i,api_keys_json_string:q,tags:p,eTag:n,licensing_json_string:o,collaborators_json_string:k,is_collection_frontend_collaborative:a.use_collaborative_editor});return s}var a0,a1=function(a){var b,d=a.author_id,f=a.collection_id,g=a.category_id,h=a.index,i=a.collectionActions,j=a.createNewArticle,k=void 0===j||j,l=a.data,m=void 0===l?{}:l,n=a.collectionType,o=void 0===n?null:n;return b=G(e().mark(function a(b){var j,l;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(j=function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:void 0;return i.addArticle({category_id:g,article:a,index:h,data:m})},k){a.next=5;break}j(),a.next=8;break;case 5:return(l=c.g.loaderContext.loaderActions.set)({isLoaded:!1,isLoading:!0}),a.abrupt("return",aK(d,f,o).then(function(a){var b=JSON.parse(a);b.author_id=d,j(b),l({isLoaded:!0,isLoading:!1})}).catch(function(a){(0,A.rU)(a,b),l({isLoaded:!1,isLoading:!1})}));case 8:case"end":return a.stop()}},a)})),function(a){return b.apply(this,arguments)}},a2=function(a){var b=a.author_id,c=a.collection_id,d=a.project_id,e=a.category_id,f=a.index,g=a.projectActions,h=a.setLoaderStateDispatch,i=void 0===h?function(a){}:h;return function(a,h){i({isLoaded:!1,isLoading:!0}),aP(b,c,d).then(function(a){var b=JSON.parse(a);g.addComponent({category_id:e,component:b,index:f}),i({isLoaded:!0,isLoading:!1})}).catch(function(b){(0,A.rU)(b,a),i({isLoaded:!1,isLoading:!1})})}},a3=function(a){var b=a.author_id,c=a.collection_id,d=a.cloud_lab_id,e=a.category_id,f=a.index,g=a.setLoaderStateDispatch,h=void 0===g?function(a){}:g,i=a.cloudLabActions,j=a.cloudLabState;return function(a){var g;if(h({isLoaded:!1,isLoading:!0}),!(null===(g=j.data)|| void 0===g?void 0:g.title)){a(v.n.show(q.ad,{status:"ERROR",text:"Lab title is required."}));return}(0,k.Z)({url:"/api/author/".concat(b,"/collection/").concat(c,"/cloud-lab/").concat(d,"/cloud-lab-task"),type:"POST"}).then(function(a){var b=JSON.parse(a);i.addTask({category_id:e,task:b,index:f}),h({isLoaded:!0,isLoading:!1})}).catch(function(b){(0,A.rU)(b,a),h({isLoaded:!1,isLoading:!1})})}},a4=function(a){var b=a.author_id,c=a.collection_id,d=a.assessment_id,e=a.category_id,f=a.index,g=a.assessment_type,h=a.addQuestion,i=a.updateQuestionTitle,j=a.question_type,k=void 0===j?"":j,l=a.setLoaderStateDispatch,m=void 0===l?function(a){}:l;return function(a){return m({isLoaded:!1,isLoading:!0}),aQ(b,c,d,g,k).then(function(a){var b=JSON.parse(a);h({category_id:e,question:J(I({},b),{question_type:k}),index:f}),g===p.Q5R.ENTERPRISE_ASSESSMENT&&i({categoryId:e,questionId:b.question_id,title:"Untitled Masterpiece"}),m({isLoaded:!0,isLoading:!1})}).catch(function(b){(0,A.rU)(b,a),m({isLoaded:!1,isLoading:!1})})}},a5=function(a){var b=a.author_id,c=a.collection_id,d=a.assessment_id,e=a.category_id,f=a.index,g=a.assessment_type,h=a.question_id,i=a.addQuestion,j=a.updateQuestionTitle,l=a.question_type,m=void 0===l?"":l;return function(a){var l,n,o,r,s;return a(v.n.show(q.ad,{status:"WAIT",text:"Cloning Question"})),(l=b,n=c,o=d,r=g,s=h,(0,k.Z)({url:"/api/author/".concat(l,"/collection/").concat(n,"/assessment/").concat(o,"/question/").concat(s,"/clone").concat(r===p.Q5R.QUESTIONNAIRE?"?assessment_type=questionnaire":""),type:"POST"})).then(function(b){var c=JSON.parse(b);i({category_id:e,question:J(I({},c),{question_type:m}),index:f}),g===p.Q5R.ENTERPRISE_ASSESSMENT&&j({categoryId:e,questionId:c.question_id,title:"Untitled Masterpiece"}),a(v.n.showOrUpdate(q.ad,{status:"SUCCESS",text:"Cloned successfully"}))}).catch(function(b){(0,A.rU)(b,a),a(v.n.showOrUpdate(q.ad,{status:"ERROR",text:(0,A.HR)(b)||"Clone failed"}))})}},a6=function(a){var b=a.collectionActions,c=a.author_id,d=a.collection_id,e=a.category_id,f=a.src_article_id,g=a.src_article_title,h=a.src_author_id,i=void 0===h?null:h,j=a.src_collection_id,k=void 0===j?null:j,l=a.sourceWorkType,m=void 0===l?null:l,n=a.url_slug,o=void 0===n?null:n,r=a.page_url_slug,s=void 0===r?null:r,t=a.showToastModal,u=void 0!==t&&t,w=a.dispatchLoadedActions,x=void 0===w||w,y=a.setLoaderStateDispatch,z=void 0===y?function(a){}:y;return function(a){return z({isLoaded:!1,isLoading:!0}),a(v.n.show(u?q.lu:q.ad,{status:p.oiP.WAIT,text:"Cloning"})),aU(c,d,f,i,k,m,o,s).then(function(c){var d=JSON.parse(c);d.title=g;var f=d.source_author_id,h=d.source_collection_id,i=d.source_page_id;b.cloneArticle({category_id:e,article:d,source_details:{is_cloned:!!f,source_author_id:f,source_collection_id:h,source_page_id:i}}),x&&(z({isLoaded:!0,isLoading:!1}),a(v.n.showOrUpdate(u?q.lu:q.ad,{status:p.oiP.SUCCESS,text:"Cloned successfully"})))}).catch(function(b){if(!x)throw b;(0,A.rU)(b,a),z({isLoaded:!1,isLoading:!1}),a(v.n.showOrUpdate(u?q.lu:q.ad,{status:p.oiP.ERROR,text:(0,A.HR)(b)||"Clone failed"}))})}},a7=(a0=G(e().mark(function a(b,c){return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(a,d){var f=i.operation({forever:!0,minTimeout:100,maxTimeout:2e3});f.attempt(G(e().mark(function g(){var h;return e().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:var g,i;return e.prev=0,e.next=3,(g=b,i=c,(0,k.Z)({url:"/api/author/".concat(g,"/collection/").concat(i,"/in_progress"),type:"GET"})).then(JSON.parse);case 3:(h=e.sent).in_progress?f.retry(Error("In Progress")):a(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),f.stop(),d(e.t0);case 11:case"end":return e.stop()}},g,null,[[0,7]])})))}));case 1:case"end":return a.stop()}},a)})),function(a,b){return a0.apply(this,arguments)}),a8=function(){for(var a,b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return a=G(e().mark(function a(b){var d,f,g,h,i,j;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return g=(f=(d=K(c,1))[0]).author_id,h=f.collection_id,i=f.showToastModal,a.prev=1,c[0].dispatchLoadedActions=!1,a.next=5,b(a6.apply(void 0,L(c)));case 5:return j=a.sent,a.next=8,a7(g,h);case 8:return c[0].setLoaderStateDispatch({isLoaded:!0,isLoading:!1}),b(v.n.showOrUpdate(i?q.lu:q.ad,{status:p.oiP.SUCCESS,text:"Cloned successfully"})),a.abrupt("return",j);case 13:a.prev=13,a.t0=a.catch(1),(0,A.rU)(a.t0,b),c[0].setLoaderStateDispatch({isLoaded:!1,isLoading:!1}),b(v.n.showOrUpdate(i?q.lu:q.ad,{status:p.oiP.ERROR,text:(0,A.HR)(a.t0)||"Clone failed"}));case 18:case"end":return a.stop()}},a,null,[[1,13]])})),function(b){return a.apply(this,arguments)}},a9=function(a,b,c,d,f){var g;return g=G(e().mark(function g(h){return e().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h(ba(a,b,c,d,f,!1));case 1:case"end":return e.stop()}},g)})),function(a){return g.apply(this,arguments)}},ba=function(a,b){var d,f=a.author_id,g=a.collection_id,h=arguments.length>2&& void 0!==arguments[2]&&arguments[2],i=arguments.length>3&& void 0!==arguments[3]?arguments[3]:p.dLO.COLLECTION,j=arguments.length>4&& void 0!==arguments[4]&&arguments[4],k=!(arguments.length>5)|| void 0===arguments[5]||arguments[5];return d=G(e().mark(function a(d,l){var m,n,o,q,r,s;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.t0=b,!a.t0){a.next=10;break}if(!k){a.next=8;break}return a.next=6,d(b);case 6:a.next=10;break;case 8:return a.next=10,b();case 10:if(o=c.g.authorCollectionActions,!h){a.next=14;break}return o.setDirty(!0),a.abrupt("return");case 14:return r=null===(m=(q=c.g.authorCollection).instance)|| void 0===m?void 0:m.details,s=J(I({},a_(q,l().dockerDetails)),{connect_infos:JSON.stringify(d(bb((null==r?void 0:r.connects)||[],o))),course_cloud_lab_id:(null==r?void 0:null===(n=r.course_cloud_lab)|| void 0===n?void 0:n.course_cloud_lab_id)||void 0}),r.work_type===p.dLO.MODULE&&(s.filtered_languages_json_string=JSON.stringify(r.filtered_languages||void 0)),a.abrupt("return",d(av({author_id:f,collection_id:g,payload:s},o,void 0,i,!1,j)));case 19:case"end":return a.stop()}},a)})),function(a,b){return d.apply(this,arguments)}},bb=function(a,b){return function(c){var d=[],e=!0,f=!1,g=void 0;try{for(var h,i=a[Symbol.iterator]();!(e=(h=i.next()).done);e=!0){var j=h.value;if(j.connect_info&&j.connect_info.length){var k=1,l=!0,m=!1,n=void 0;try{for(var o,q=j.connect_info[Symbol.iterator]();!(l=(o=q.next()).done);l=!0){var r=o.value,s={id:r.id,title:r.title,status:r.status,full_name:r.full_name,email:r.email,index:r.status===p.BMk.DELETED?1e4:k++};if(j.dirty||delete s.index,!r.title&&(delete s.title,r.status!==p.BMk.DELETED))return;r.email||(delete s.email,delete s.full_name),(j.dirty||r.dirty)&&(d.push(s),b.setConnectInfoDirtyFlag({weekId:j.week_id,id:r.id,flag:!1}))}}catch(t){m=!0,n=t}finally{try{l||null==q.return||q.return()}finally{if(m)throw n}}}b.setConnectDirtyFlag({weekId:j.week_id,flag:!1})}}catch(u){f=!0,g=u}finally{try{e||null==i.return||i.return()}finally{if(f)throw g}}return d}},bc=function(a,b,c){return function(d,e){var f,g=null==b?void 0:null===(f=b.instance)|| void 0===f?void 0:f.details,h=g.author_id,i=g.collection_id,j=g.work_type||p.dLO.COLLECTION,k=a_(b,e().dockerDetails);return d(av({author_id:h,collection_id:i,payload:k},c,void 0,j,a))}},bd=function(a,b){return(0,k.Z)({url:"/api/notifications/".concat(a,"/").concat(b),type:"POST"})},be=function(a){var b=a.author_id,c=a.collection_id,d=a.assessment_id,e=a.question_id,f=a.protectedContent,g=a.assessment_type,h=void 0===g?p.Q5R.REGULAR:g;return(0,k.Z)({url:"/api/".concat(h===p.Q5R.SKILL_ASSESSMENT?"skill-assessment":"assessment","/").concat(b,"/").concat(c,"/").concat(d,"/").concat(e,"?assessment_type=").concat(h),type:"POST",data:{answer:JSON.stringify(f),timestamp:new Date().toISOString()}},!0)},bf=function(a){return(0,k.Z)({url:"/api/learning-plans/questionnaire/modules-info",type:"POST",data:{linked_modules_ids:JSON.stringify(a)}})},bg=function(a){var b=a.author_id,c=a.collection_id,d=a.assessment_id,e=a.assessment_type,f=void 0===e?p.Q5R.REGULAR:e,g=a.discard_attempt,h=a.pathAuthorId,i=void 0===h?null:h,j=a.pathId,l=void 0===j?null:j;return(0,k.Z)({url:"/api/".concat([p.Q5R.SKILL_ASSESSMENT,p.Q5R.ENTERPRISE_ASSESSMENT,].includes(f)?"skill-assessment":"assessment","/").concat(b,"/").concat(c,"/").concat(d,"?assessment_type=").concat(f).concat(void 0!==g&&g?"&discard=true":""),type:"POST",data:I({timestamp:new Date().toISOString()},i&&l?{path_author_id:i,path_id:l}:{})},!0)},bh=function(a){var b=a.authorId,c=a.workId,d=a.projectId,e=a.keysToDelete;return(0,k.Z)({url:"/api/project/".concat(b,"/").concat(c,"/").concat(d),type:"POST",data:{map_name:(0,j.LZ)({authorId:b,collectionId:c,documentId:d}),env_keys:JSON.stringify(e)}},!0)},bi=function(a,b,c){return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/assessment/").concat(c,"/udata/upload/url"),type:"GET"})},bj=function(a,b,c){return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/project/").concat(c,"/udata/upload/url"),type:"GET"})},bk=function(a,b,c){return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/cloudlab/").concat(c,"/udata/upload/url"),type:"GET"})},bl=function(a,b,c,d){var e=arguments.length>4&& void 0!==arguments[4]?arguments[4]:p.Q5R.REGULAR,f="/api/".concat(e===p.Q5R.SKILL_ASSESSMENT?"skill-assessment":"assessment","/begin/").concat(a,"/").concat(b,"/").concat(c,"?assessment_type=").concat(e);return d&&(f+="&continue=".concat(d)),(0,k.Z)({url:f,type:"POST"})},bm=function(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]&&arguments[3],e=arguments.length>4?arguments[4]:void 0,f=h.stringify(I({},d?{end_previous:!0}:{},e?{parent_work_info:e}:{})),g="/api/cloud-lab/".concat(a,"/").concat(b,"/").concat(c,"/user-lab").concat(f?"?".concat(f):"");return(0,k.Z)({url:g,type:"PUT"})},bn=function(a,b,c){return(0,k.Z)({url:"/api/cloud-lab/".concat(a,"/").concat(b,"/").concat(c,"/user-lab"),type:"GET"})},bo=function(a,b,c){var d="/api/cloud-lab/".concat(a,"/").concat(b,"/").concat(c,"/user-lab");return(0,k.Z)({url:d,type:"POST"})},bp=function(a){var b=a.author_id,c=a.collection_id,d=a.cloud_lab_id,e="/api/cloud-lab/".concat(b,"/").concat(c,"/").concat(d,"/console");return(0,k.Z)({url:e,type:"GET"})},bq=function(a,b,c,d,e){return(0,k.Z)({url:"/api/".concat(a,"/").concat(b,"/").concat(c,"/").concat(d,"/").concat(e,"/read-time"),type:"GET"})},br=function(a,b){return(0,k.Z)({url:"/api/collection/".concat(a,"/").concat(b,"/related-content"),type:"GET"})},bs=function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:"",b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:"",c=arguments.length>2&& void 0!==arguments[2]?arguments[2]:"",d=arguments.length>3&& void 0!==arguments[3]&&arguments[3],e=c||"".concat(a,"/").concat(b);return(0,k.Z)({url:"/api/collection/".concat(e,"/get-recommendations").concat(d?"?fetch_recommendation_details=true":""),type:"GET"})},bt=function(a){return(0,k.Z)({url:"/api/userfeedback?".concat(a),type:"GET"})},bu=function(a,b,c,d,e){var f={user_id:d,connect_infos:JSON.stringify(e)};return(0,k.Z)({url:"/api/enterprise/".concat(b,"/").concat(c,"/").concat(a,"/connect"),type:"PUT",data:f})},bv=function(a,b,c,d,e){return(0,k.Z)({url:"/api/enterprise/".concat(b,"/").concat(c,"/").concat(a,"/connect/status"),type:"PUT",data:{id:d,status:e}})},bw=function(a,b,c){return(0,k.Z)({url:"/api/enterprise/".concat(a,"/").concat(b,"/").concat(c,"/connect"),type:"GET"})},bx=function(){return(0,k.Z)({url:"/api/author/learning-plans/modules?instance_status=".concat(p.dTF.PUBLISHED),type:"GET"})},by=function(a,b,c){return(0,k.Z)({url:"/api/author/learning-plans/".concat(a,"/").concat(b,"/").concat(c),type:"POST"})},bz=function(a,b,c){return(0,k.Z)({url:"/api/author/learning-plans/".concat(a,"/").concat(b,"/").concat(c),type:"GET"})},bA=function(a){return(0,k.Z)({url:"/api/external/image?url=".concat(encodeURIComponent(a)),type:"GET"})},bB=function(a,b){return(0,k.Z)({url:"/api/author/".concat(a,"/").concat(b,"/clone-template-module"),type:"POST"})},bC=function(a,b){return(0,k.Z)({url:"/api/author/".concat(a,"/collection/").concat(b,"/collaborative_editor_status"),type:"GET"})},bD=function(a,b){return(0,k.Z)({url:"/api/dependency-link/multi-variant-content?author_id=".concat(a,"&work_id=").concat(b),type:"GET"})},bE=function(a){var b=a.organizationId;return(0,k.Z)({url:"/api/enterprise/".concat(b,"/dashboard/track-progress/dropdowns"),type:"GET"})},bF=function(a){var b=a.organizationId,c=a.assignment_map;return(0,k.Z)({url:"/api/enterprise/".concat(b,"/dashboard/track-progress/time-spent"),type:"POST",data:{assignment_map:JSON.stringify(c)}})},bG=function(a){var b=a.organizationId,c=a.conditionalFilters,d=a.currentPage,e=a.engineName,f=a.excludeFilters,g=a.excludeSearchFields,h=a.facets,i=a.groupField,j=a.includeFilters,l=a.includeSearchFields,m=a.recordAnalytics,n=a.resultsPerPage,o=a.searchString,p=a.tags,q=a.sort_filter;return(0,k.Z)({data:{conditional_filters:JSON.stringify(c.map(function(a){var b=a.field,c=a.values;return{field:b,values:JSON.stringify(c)}})),current_page:d,engine_name:e,exclude_filters:JSON.stringify(f.map(function(a){var b=a.field,c=a.values;return{field:b,values:JSON.stringify(c)}})),exclude_search_fields:JSON.stringify(void 0===g?[]:g),facets:JSON.stringify(h),group_field:i,include_filters:JSON.stringify(j.map(function(a){var b=a.field,c=a.values;return{field:b,values:JSON.stringify(c)}})),include_search_fields:JSON.stringify(void 0===l?[]:l),record_analytics:m,results_per_page:n,search_string:o,tags:JSON.stringify(void 0===p?[]:p),sort_filter:JSON.stringify(void 0===q?[]:q),from_engine:!1},type:"POST",url:"/api/enterprise/".concat(b,"/dashboard/track-progress")}).then(JSON.parse)},bH=function(a){var b=a.organizationId,c=a.includeFilters,d=a.searchString,e=a.sortFilter;return(0,k.Z)({data:{include_filters:JSON.stringify(c.map(function(a){var b=a.field,c=a.values;return{field:b,values:JSON.stringify(c)}})),search_string:d,sort_filter:JSON.stringify(void 0===e?[]:e),from_engine:!1},type:"POST",url:"/api/enterprise/".concat(b,"/dashboard/track-progress/download")})},bI=function(a){return(0,k.Z)({type:"GET",url:"/api/enterprise/track-progress/download?time=".concat(a)})},bJ=function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:[],b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&& void 0!==arguments[2]?arguments[2]:[],d=arguments.length>3?arguments[3]:void 0;return(0,k.Z)({data:{user_ids_list:JSON.stringify(a),author_work_ids_list:JSON.stringify(b),user_emails_list:JSON.stringify(c)},type:"POST",url:"/api/enterprise/".concat(d,"/dashboard/track-progress/check-new-assignment")})},bK=function(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]&&arguments[3],e="/api/learning-plan/".concat(a,"/").concat(b,"/update-week").concat(d?"?inactive=true":"");return(0,k.Z)({url:e,type:"POST",data:{week_number:c}})},bL=function(a,b){return(0,k.Z)({url:"/api/enterprise/assign-count/".concat(a),type:"POST",data:{works:JSON.stringify(b)}})},bM=function(a,b,c){return(0,k.Z)({url:"/api/enterprise/".concat(a,"/works/published-count?is_module=").concat(b,"&is_plan=").concat(c),type:"GET"})},bN=function(){return(0,k.Z)({url:"/api/reader/saved-works-ids",type:"GET"})},bO=function(){return(0,k.Z)({url:"/api/reader/github-student-pack",type:"GET"})}},40643:function(a,b,c){c.d(b,{AM:function(){return j},HV:function(){return l},IE:function(){return m},IR:function(){return k},Pn:function(){return i},TE:function(){return h},WD:function(){return g},ot:function(){return e},qL:function(){return d},y:function(){return f}});var d="application/vnd.android.package-archive",e={APK_MODE:"apkMode",COMMAND_MODE:"commandMode"},f={BROWSER:"browserMode",LOCAL:"localMode"},g={APK:"apk",COMMAND:"command"},h={UPLOAD_PENDING:"UPLOAD_PENDING",UPLOAD_FAILED:"UPLOAD_FAILED",UPLOADING:"UPLOADING",UPLOAD_SUCCESSFUL:"UPLOAD_SUCCESSFUL",UPLOAD_MAX_SIZE_EXCEEDED:"UPLOAD_MAX_SIZE_EXCEEDED",UPLOAD_NAME_INCORRECT:"UPLOAD_NAME_INCORRECT"},i={RUN_APPLICATION:"RUN_APPLICATION",CONNECT:"CONNECT",ERROR:"ERROR",RUNNING:"RUNNING"},j={DOWNLOADING:"Downloading Apk",LAUNCHING:"Launching Activity",CONNECTING:"Connecting",DEFAULT:""},k={DOWNLOADING:"DOWNLOADING",LAUNCHING:"LAUNCHING",CONNECTING:"CONNECTING",DEFAULT:"DEFAULT"},l=function(){return{apk:void 0,id:null,name:null,size:null,gcsObjectName:void 0,uploadStatus:h.UPLOAD_PENDING}},m=function(a,b,c){var d="";return a===e.APK_MODE?(d+='curl -o downloadedApk.apk "{{downloadLink}}" && \\ \n',d+="adb install -r downloadedApk.apk && \\ \n",d+="adb shell am start -n ".concat(b.apkMode.packageName,"/").concat(b.apkMode.activityName)):d+="adb shell "+b.commandMode.commandToExecute.replace("{{EDUCATIVE_LIVE_VM_URL}}",c),d}},34290:function(a,b,c){c.r(b),c.d(b,{CLOUD_LAB_ACCOUNT_ID:function(){return al},CLOUD_LAB_PROOFREAD_FEATURE_FLAG:function(){return ak},CONSOLE_LOGOUT_URL:function(){return V},COURSE_CLOUD_LAB_CSP:function(){return ai},COURSE_CLOUD_LAB_WIDGET_GROUPS_FEATURE_FLAG:function(){return aj},CloudLabType:function(){return T},ConsoleUrlButton:function(){return ag},CourseCloudLabWidgetWrapper:function(){return $},DEFAULT_TIME_LIMIT:function(){return am},PolicyVerificationStatus:function(){return Y},ValidatePolicyButton:function(){return X},WidgetGroupsList:function(){return Z},courseCloudLabAfterEndAction:function(){return ah},credentialFields:function(){return U},endAndStartNewLab:function(){return ad},getAutoGeneratedEnvAndApiKeys:function(){return _},getWidgetCloudId:function(){return ac},loadDeletedDocuments:function(){return an},onRecoverDeletedTask:function(){return ao},populateCloudCredentials:function(){return aa},providers:function(){return S},redirectToCloudLabHomePage:function(){return W},setCredentialAsApiKeysAndEnvKeys:function(){return ab},showLabExistWarning:function(){return ae},startCourseCloudLab:function(){return af},times:function(){return R},toggleDeletedCloudLabs:function(){return ap}});var d=c(54551),e=c.n(d),f=c(66729),g=c(73242),h=c(83249),i=c(76395),j=c(38389),k=c(10308),l=function(a,b,c,d,e){var f=arguments.length>5&& void 0!==arguments[5]&&arguments[5],g="/api/cloud-course-session/".concat(a,"/").concat(b,"/").concat(e,"?end_previous=").concat(f);return(0,k.Z)({url:g,type:"PUT",data:{active_group_id:d,active_page_id:c}})},m=c(67186),n=c(45247),o=c(24427),p=c(3519),q=c(71653),r=c(16560),s=c(36093),t=c(24400),u=c(68361),v=c(78333),w=c.n(v),x=c(22989),y=c(62171),z=c(65750),A=c(46989),B=c(84744),C=c(18322),D=c(88674),E=c(35239),F=c(96458);function G(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function H(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function I(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){H(f,d,e,g,h,"next",a)}function h(a){H(f,d,e,g,h,"throw",a)}g(void 0)})}}function J(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function K(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){J(a,b,c[b])})}return a}function L(a,b){return b=null!=b?b:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):(function(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);c.push.apply(c,d)}return c})(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))}),a}function M(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(a,b){var c,d,e=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=e){var f=[],g=!0,h=!1;try{for(e=e.call(a);!(g=(c=e.next()).done)&&(f.push(c.value),!b||f.length!==b);g=!0);}catch(i){h=!0,d=i}finally{try{g||null==e.return||e.return()}finally{if(h)throw d}}return f}}(a,b)||O(a,b)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(a){return function(a){if(Array.isArray(a))return G(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||O(a)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(a,b){if(a){if("string"==typeof a)return G(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return G(a,b)}}var P,Q,R=[{title:"15 minutes",value:15},{title:"30 minutes",value:30},{title:"45 minutes",value:45},{title:"1 hour",value:60},{title:"1 hour 30 minutes",value:90},{title:"2 hours",value:120},{title:"2 hours 30 minutes",value:150},{title:"3 hours",value:180},],S=[{title:"AWS",value:1},{title:"Azure",value:2},{title:"GCP",value:3},],T={CLOUD_LAB:1,CLOUD_COURSE:2,STANDALONE_CLOUD_LAB:3},U=[{name:"Sign-in URL",key:"sign_in_url",eventAction:D.bt.SIGN_IN_URL_COPY_CLICKED},{name:"Username",key:"username",eventAction:D.bt.USERNAME_COPY_CLICKED},{name:"Password",key:"password",eventAction:D.bt.PASSWORD_COPY_CLICKED},{name:"Access Key ID",key:"access_key_id",eventAction:D.bt.ACCESS_KEY_COPY_CLICKED},{name:"Secret Access Key",key:"secret_access_key",eventAction:D.bt.SECRET_KEY_COPY_CLICKED},],V="https://signin.aws.amazon.com/oauth?Action=logout",W=function(a,b,c,d,e,f,g,h,i){a.push("".concat(g&&h&&i?"/collection/page/".concat(g,"/").concat(h,"/").concat(i,"/cloudlab"):e&&f?"/cloudlabs/".concat(e):"/collection/page/".concat(b,"/").concat(c,"/").concat(d,"/cloudlab")))},X=function(a){var b=a.onClick,c=a.disabled;return(0,f.jsx)("button",{disabled:c,className:"outlined-default",onClick:function(){return b()},children:"Verify Policy"})},Y=function(a){var b=a.policyFindings,c=a.policyErrors,d=a.policyWarns;return(0,f.jsxs)("div",{className:"mt-2 w-full",children:[b.loading&&(0,f.jsx)(m.default,{}),b.loaded&&(0,f.jsx)("div",{className:"whitespace-pre-wrap rounded border border-solid p-3 font-mono",children:0===c.length&&0===d.length?(0,f.jsx)("span",{className:"text-green-800 dark:text-green-500",children:"No errors or warnings found"}):(0,f.jsxs)(f.Fragment,{children:[c.length>0&&(0,f.jsxs)("div",{className:"mb-3 text-red-500 dark:text-red-300",children:[(0,f.jsx)("p",{children:"Errors:"}),c.join("\n")]}),d.length>0&&(0,f.jsxs)("div",{className:"text-orange-900 dark:text-orange-200",children:[(0,f.jsx)("p",{children:"Security Warnings:"}),d.join("\n")]})]})})]})},Z=function(a){var b=a.disabled,c=void 0!==b&&b,d=a.widgetGroups,e=a.setCourseCloudLabWidgetGroups,i=(0,h.useState)(d||[]),j=i[0],k=i[1],l=function(a,b){var c;c=a?N(j).concat([{id:(0,g.x0)(5),group_name:""}]):j.filter(function(a,c){return c!==b}),k(c)},m=function(a,b){k(j.map(function(c){return c.id===b?{id:b,group_name:a}:c}))},n=function(){e(j.filter(function(a){return a.group_name&&""!==a.group_name.trim()}))},o=j.map(function(a,b){var d=j.length-1===b,e=0===b,g=!e&&d&&!j[b].group_name;return(0,f.jsxs)("div",{className:"m-1 flex",children:[(0,f.jsx)(C.Z,{placeholder:"e.g. dynamoDB",disabled:c||e,defaultValue:a.group_name,onChange:function(b){m(b.target.value,a.id)},className:"mr-2"},a.id),(0,f.jsx)(u.Z,{disabled:c|| !d&&e,variant:"small",onClick:function(){g||l(d,b)},value:d?"+":"-",color:"black",className:"mr-3 mt-4 h-6 w-6 ".concat(g?w().disabled:""),children:d?"+":"-"})]})});return(0,f.jsxs)("div",{className:"flex flex-col p-3",onBlur:function(){n()},children:[(0,f.jsx)("span",{className:"text-lg font-semibold text-black dark:text-gray-D200",children:"Widget Groups"}),o]})},$=function(a){var b,c=a.courseCloudLab,d=a.widgetContent,e=a.updateContentState,g=a.children,h=null==c?void 0:c.widget_groups,i=function(a){var b=h.findIndex(function(b){return b.id===a});return -1===b?0:b},j=function(a){e({cloud_session_group:{id:a}})};return(0,f.jsxs)(f.Fragment,{children:[aj&&(0,f.jsxs)("div",{className:"mb-2 inline-flex flex-row",children:[(0,f.jsx)("span",{className:"p-2 pb-0 text-lg font-semibold text-black dark:text-gray-D200",children:"Select Course Cloud Lab widget group"}),(0,f.jsx)(A.Z,{value:null==d?void 0:null===(b=d.cloud_session_group)|| void 0===b?void 0:b.id,renderValue:function(){var a,b;return null==h?void 0:null===(b=h[i(null==d?void 0:null===(a=d.cloud_session_group)|| void 0===a?void 0:a.id)])|| void 0===b?void 0:b.group_name},onChange:function(a){j(a)},customClass:"w-64",children:h.map(function(a){return(0,f.jsx)(B.Z,{value:a.id,children:a.group_name},a.id)})})]}),g]})},_=function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{},b=arguments.length>1&& void 0!==arguments[1]&&arguments[1];return[F.MC,F.OP].map(function(c){return K({id:c,key:c,name:c,value:c in a?a[c]:"",useAsDefault:!0},b&&{info:"",required:!1,deleted:!1})})},aa=function(a,b){var c={};_(b||{},!0).forEach(function(a){return c[a.key]=a});var d=((null==a?void 0:a.envs)||[]).map(function(a){return a.key in c?L(K({},a),{value:c[a.key].value}):a});return L(K({},a),{envs:d.concat(Object.values(c))})},ab=function(a,b,d,e,f){var g,h,i,j,k,l,m,n,o=null==b?void 0:null===(g=b.instance)|| void 0===g?void 0:null===(h=g.details)|| void 0===h?void 0:h.api_keys;o=null==o?void 0:o.filter(function(a){return!s.s.includes(a.id)});var p=null==b?void 0:null===(i=b.instance)|| void 0===i?void 0:null===(j=i.details)|| void 0===j?void 0:null===(k=j.docker)|| void 0===k?void 0:k.envs;p=null==p?void 0:p.filter(function(a){return!s.s.includes(a.id)});var q=[];Object.keys(d||{}).forEach(function(a){var b=[F.MC,F.OP,al,].includes(a)?ai.concat("_"+a):a;q.push({id:b,key:b,name:b,value:null==d?void 0:d[a]})});var r=q;r=r.map(function(a){return L(K({},a),{deleted:!1,useAsDefault:!0,defaultValue:a.value})}),c.g.authorCollectionActions.set(L(K({},b),{instance:L(K({},b.instance),{details:L(K({},b.instance.details),{course_cloud_lab:L(K({},null===(l=b.instance.details)|| void 0===l?void 0:l.course_cloud_lab),{active_group_id:e,active_page_id:f}),user_course_cloud_lab:K({},null===(m=b.instance.details)|| void 0===m?void 0:m.user_course_cloud_lab,d),api_keys:N(o).concat(N(q)),docker:L(K({},null===(n=b.instance.details)|| void 0===n?void 0:n.docker),{envs:N(p).concat(N(r))})})})}));var t=N(p).concat(N(r));a(x.ry.saveEnvs({envs:t}))},ac=function(a){var b,c,d=a.comps,e=a.hash,f=d,g=null==f?void 0:null===(b=f[e])|| void 0===b?void 0:null===(c=b.content)|| void 0===c?void 0:c.cloud_session_group;return g?null==g?void 0:g.id:""},ad=function(a,b,c){var d,e,f,g,h,i,k,l,m,n=a.pageId,o=a.collection,p=a.dispatch,q=o.authorId,r=o.collectionId;return((null==o?void 0:null===(d=o.instance)|| void 0===d?void 0:null===(e=d.details)|| void 0===e?void 0:null===(f=e.course_cloud_lab)|| void 0===f?void 0:f.admin)?(0,t.JL)(q,r,null==o?void 0:null===(g=o.instance)|| void 0===g?void 0:null===(h=g.details)|| void 0===h?void 0:null===(i=h.course_cloud_lab)|| void 0===i?void 0:i.course_cloud_lab_id):(0,j.e)(q,r,null==o?void 0:null===(k=o.instance)|| void 0===k?void 0:null===(l=k.details)|| void 0===l?void 0:null===(m=l.course_cloud_lab)|| void 0===m?void 0:m.course_cloud_lab_id)).then(function(){af({pageId:n,collection:o,dispatch:p},b,c)})},ae=function(a,b){var c=arguments.length>2&& void 0!==arguments[2]&&arguments[2],d=arguments.length>3&& void 0!==arguments[3]?arguments[3]:function(){},e=c?"session":"lab";return a(y.n.show(r.zN,{onConfirm:b,onCancel:d,onClose:d,cancelText:"Cancel",confirmText:"End Lab",title:"A cloud ".concat(e," is already running"),description:"Do you want to end the current cloud ".concat(e," and start a new one?"),danger:!0,styleType:"leftAligned"}))},af=function(a,b,c){var d,e,f,g,h=a.pageId,i=a.collection,j=a.dispatch,k=arguments.length>3&& void 0!==arguments[3]&&arguments[3],m=i.authorId,n=i.collectionId,o=null==i?void 0:null===(d=i.instance)|| void 0===d?void 0:null===(e=d.details)|| void 0===e?void 0:e.course_cloud_lab,p=null==i?void 0:null===(f=i.instance)|| void 0===f?void 0:null===(g=f.details)|| void 0===g?void 0:g.url_slug,q=null==o?void 0:o.admin;return(q?(0,t.qu)(m,n,null==o?void 0:o.course_cloud_lab_id,!1,b,h):l(m,n,h,b,null==o?void 0:o.course_cloud_lab_id,k)).then(function(a){(a=JSON.parse(a))&&(ab(j,i,Object.fromEntries(s.s.map(function(b){return[b,a[b.replace(ai+"_","")],]})),b,h),c({type:"setInProgressLab",payload:K({author_id:m,collection_id:n,cloud_lab_id:null==o?void 0:o.course_cloud_lab_id,title:"",end_time:Date.now()+6e4*o.time_limit,active_page_id:h,course_url_slug:p,test_mode:q,setup_status:a.setup_status},a.sign_in_url&&{sign_in_url:a.sign_in_url})}))})},ag=function(a){var b=a.setup_status,c=a.sign_in_url,d=a.author_id,e=a.collection_id,g=a.cloud_lab_id,j=a.disable_federated_login,k=a.setLabSetupStatus,l=a.labCompleted,m=a.eventCategory,r=a.className,s=a.labEndTime,u=(0,z.TL)(),v=(0,h.useState)(!0),w=v[0],x=v[1],A=(0,h.useState)(""),B=A[0],C=A[1],E=(0,h.useRef)(null),F=function(){Date.now()<s&&(0,i.EX)({author_id:d,collection_id:e,cloud_lab_id:g}).then(JSON.parse).then(function(a){C(a.url),x(!1)}).catch(function(a){C(c),x(!1)})};return(0,h.useEffect)(function(){if(j){C(c),x(!1);return}return null==E.current&&(F(),E.current=setInterval(F,87e4)),function(){E.current&&clearInterval(E.current),E.current=null}},[s]),(0,h.useEffect)(function(){var a=null;return b===q.Psf.IN_PROGRESS&&(a=(0,t.d1)(d,e,g,k)),function(){a&&clearInterval(a)}},[k,b]),(0,f.jsxs)("div",{className:"".concat(void 0===r?"":r," inline-flex"),children:[b===q.Psf.FAILED&&(0,f.jsx)(o.default,{overlay:"Configuration Failed",parentClasses:"cursor-pointer inline-flex items-center justify-center mr-2",position:"bottom",children:(0,f.jsx)(p.Z,{className:"h-4 w-4 text-orange-500"})}),(0,f.jsx)("button",{className:"h-full select-none border-2 border-solid border-indigo-500 bg-indigo-500 py-2 font-bold ".concat(b===q.Psf.IN_PROGRESS||w?"".concat(w?"w-32":""," cursor-default focus:outline-0"):""," dark:bg-indigo-500"),disabled:void 0!==l&&l,onClick:function(){!w&&b!==q.Psf.IN_PROGRESS&&((0,D.qP)(m,D.bt.CLOUD_LAB_CLICKED_OPEN_CONSOLE_BUTTON),fetch(V,{mode:"no-cors",credentials:"include"}).finally(function(){window.open(B,"_blank","noopener, noreferrer")}),B!==c&&u(y.n.close()))},children:b===q.Psf.IN_PROGRESS?(0,f.jsxs)("div",{className:"flex h-full items-center justify-center",children:[(0,f.jsx)(n.Z,{size:20,color:"text-white"}),(0,f.jsx)("span",{className:"ml-1",children:"Configuring..."})]}):w?(0,f.jsx)(n.Z,{size:24,contrast:!0}):"Open Console"})]})},ah=function(a,b,c){var d,e,f,g,h,i,j,k,l=null==a?void 0:null===(d=a.instance)|| void 0===d?void 0:null===(e=d.details)|| void 0===e?void 0:e.api_keys;l=(l||[]).filter(function(a){return!s.s.includes(a.id)});var m=null==a?void 0:null===(f=a.instance)|| void 0===f?void 0:null===(g=f.details)|| void 0===g?void 0:null===(h=g.docker)|| void 0===h?void 0:h.envs;m=(m||[]).filter(function(a){return!s.s.includes(a.id)});var n=null==a?void 0:null===(i=a.instance)|| void 0===i?void 0:null===(j=i.details)|| void 0===j?void 0:j.course_cloud_lab;c.set(L(K({},a),{instance:L(K({},a.instance),{details:L(K({},a.instance.details),{course_cloud_lab:L(K({},n),{active_group_id:null,active_page_id:null}),user_course_cloud_lab:null,api_keys:l,docker:L(K({},null===(k=a.instance.details)|| void 0===k?void 0:k.docker),{envs:m})})})})),b(x.ry.saveEnvs({envs:m}))},ai="aws",aj=(0,E.a8)()||(0,E.ZP)(),ak=!0,al="account_id",am=30,an=(P=I(e().mark(function a(b,c,d){var f,g,h,j;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,i.CI)(b,c,q.qen.CLOUD_LAB_TASK);case 3:return j=Object.entries(h=(g=JSON.parse(f=a.sent)).deletion_times).map(function(a,b){var c=M(a,2),d=c[0],e=c[1];return{taskId:d,deletionTime:e}}),a.abrupt("return",{data:j});case 9:a.prev=9,a.t0=a.catch(0),d({loaded:!1,loading:!1,data:[]});case 12:case"end":return a.stop()}},a,null,[[0,9]])})),function(a,b,c){return P.apply(this,arguments)}),ao=function(a,b,c,d,e){a((0,t.ms)(void 0,c.addTask({category_id:d,task:{cloud_lab_task_id:b},index:null,title:"Recovered Task: "+b}),!0,!1)),e(function(a){return L(K({},a),{data:a.data.filter(function(a){return a.taskId!==b})})})},ap=(Q=I(e().mark(function a(b,c,d){var f;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d(function(a){return L(K({},a),{loading:!0})}),a.next=3,an(b,c,d);case 3:f=a.sent.data,d(function(a){return{data:f,loaded:!a.loaded,loading:!a.loading}});case 5:case"end":return a.stop()}},a)})),function(a,b,c){return Q.apply(this,arguments)})},96458:function(a,b,c){c.d(b,{KN:function(){return j},MC:function(){return g},Ny:function(){return m},OP:function(){return h},Xr:function(){return l},an:function(){return k},qC:function(){return i}});var d=c(73242);function e(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function f(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){e(a,b,c[b])})}return a}var g="access_key_id",h="secret_access_key",i='cd /usr/local/bin && aws configure set aws_access_key_id "$'.concat(g,'"  && aws configure set aws_secret_access_key "$').concat(h,'" && aws configure set region us-east-1'),j=function(a){return(null==a?void 0:a.ids)?a.ids.map(function(b){return a.entities[b]}):a},k=function(a,b){var c=RegExp("\\/".concat(b,"\\/image\\/\\d+\\?page_type=cloud_lab_task"),"g");return JSON.parse(JSON.stringify(a).replace(c,function(a){return a.replace(/page_type=cloud_lab_task/,"page_type=cloud_lab")}))},l={CLOUD_SHELL:"CloudShell",WORKSPACE:"CloudLabWorkspace"},m=function(a){var b,c,e,g,h,i,j,k,m,n,o,p,q=null!==(h=null===(b=a.content)|| void 0===b?void 0:b.content)&& void 0!==h?h:a.content,r=null!==(i=null===(c=a.content)|| void 0===c?void 0:c.envContent)&& void 0!==i?i:{};return o=f({},a),p=(p={content:q,envContent:{codeContent:f({comp_id:null!==(j=null==r?void 0:null===(e=r.codeContent)|| void 0===e?void 0:e.comp_id)&& void 0!==j?j:(0,d.x0)(),version:null!==(k=null==r?void 0:null===(g=r.codeContent)|| void 0===g?void 0:g.version)&& void 0!==k?k:1},null!==(m=null==r?void 0:r.codeContent)&& void 0!==m?m:{}),type:null!==(n=null==r?void 0:r.type)&& void 0!==n?n:l.CLOUD_SHELL}},p),Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(p)):(function(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);c.push.apply(c,d)}return c})(Object(p)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(p,a))}),o}},24400:function(a,b,c){c.d(b,{B4:function(){return Y},EM:function(){return X},FM:function(){return ah},H:function(){return T},He:function(){return W},JL:function(){return _},Lq:function(){return R},Oq:function(){return Q},Pc:function(){return ak},Q9:function(){return ag},WR:function(){return U},Xw:function(){return ar},Xz:function(){return as},d1:function(){return ae},i5:function(){return aa},j6:function(){return ac},l1:function(){return ab},ms:function(){return aj},qu:function(){return Z},tY:function(){return V},xf:function(){return ad}});var d,e,f=c(54551),g=c.n(f),h=c(66729),i=c(73242),j=c(95175),k=c(83249),l=c(1489),m=c(95763),n=c(10308),o=c(93743),p=c(67481),q=c(71653),r=c(16560),s=c(30797),t=c(95410),u=c(96458),v=c(5770),w=c(965),x=c(22989),y=c(50323),z=c(62171),A=c(65750),B=c(25657),C=c(59544),D=c(61814),E=c(10907),F=c(43521),G=c(28399),H=c(93400);function I(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function J(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function K(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){J(f,d,e,g,h,"next",a)}function h(a){J(f,d,e,g,h,"throw",a)}g(void 0)})}}function L(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function M(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){L(a,b,c[b])})}return a}function N(a,b){return b=null!=b?b:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):(function(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);c.push.apply(c,d)}return c})(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))}),a}function O(a){return function(a){if(Array.isArray(a))return I(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||P(a)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(a,b){if(a){if("string"==typeof a)return I(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return I(a,b)}}(d=e||(e={}))[d.CLEAR=0]="CLEAR",d[d.CLEAR_TASK=1]="CLEAR_TASK",d[d.ON_SAVE_SUCCESS=2]="ON_SAVE_SUCCESS",d[d.UPDATE_LAB_PRICE=3]="UPDATE_LAB_PRICE",d[d.UPDATE_TITLE=4]="UPDATE_TITLE",d[d.UPDATE_TIME_LIMIT=5]="UPDATE_TIME_LIMIT",d[d.UPDATE_CLOUD_LAB_WIDGET_COMPONENT=6]="UPDATE_CLOUD_LAB_WIDGET_COMPONENT",d[d.UPDATE_CLOUD_LAB_TASK_WIDGET=7]="UPDATE_CLOUD_LAB_TASK_WIDGET",d[d.CLEAR_TASK_WIDGETS=8]="CLEAR_TASK_WIDGETS",d[d.ADD_USER_DATA_RESOURCE_FILE=9]="ADD_USER_DATA_RESOURCE_FILE",d[d.UPDATE_USER_DATA_RESOURCE_FILE=10]="UPDATE_USER_DATA_RESOURCE_FILE",d[d.REMOVE_USER_DATA_RESOURCE_FILE=11]="REMOVE_USER_DATA_RESOURCE_FILE",d[d.UPDATE_CLOUD_PROVIDER=12]="UPDATE_CLOUD_PROVIDER",d[d.UPDATE_SUMMARY=13]="UPDATE_SUMMARY",d[d.UPDATE_WIDGETS_GROUP=14]="UPDATE_WIDGETS_GROUP",d[d.UPDATE_LANDING_PAGE_CONTENT=15]="UPDATE_LANDING_PAGE_CONTENT",d[d.UPDATE_RELEVANT_COURSES=16]="UPDATE_RELEVANT_COURSES",d[d.UPDATE_CONTENT=17]="UPDATE_CONTENT",d[d.UPDATE_TASK_CODE_CONTENT=18]="UPDATE_TASK_CODE_CONTENT",d[d.UPDATE_CODING_ENV=19]="UPDATE_CODING_ENV",d[d.UPDATE_POLICY=20]="UPDATE_POLICY",d[d.UPDATE_SETUP_SCRIPT=21]="UPDATE_SETUP_SCRIPT",d[d.UPDATE_CLI_ENABLED=22]="UPDATE_CLI_ENABLED",d[d.TOGGLE_CODING_ENV=23]="TOGGLE_CODING_ENV",d[d.UPDATE_LOGIN_CONSOLE=24]="UPDATE_LOGIN_CONSOLE",d[d.UPDATE_CLI_DOCKER_JOB_KEY=25]="UPDATE_CLI_DOCKER_JOB_KEY",d[d.UPDATE_TASK_RUNNER=26]="UPDATE_TASK_RUNNER",d[d.UPDATE_STATUS=27]="UPDATE_STATUS",d[d.UPDATE_IS_POLICY_VALID=28]="UPDATE_IS_POLICY_VALID",d[d.UPDATE_DOCKER=29]="UPDATE_DOCKER",d[d.ADD_CATEGORY=30]="ADD_CATEGORY",d[d.ADD_TASK=31]="ADD_TASK",d[d.UPDATE_CATEGORY_TITLE=32]="UPDATE_CATEGORY_TITLE",d[d.UPDATE_TASK_TITLE=33]="UPDATE_TASK_TITLE",d[d.REMOVE_TASK=34]="REMOVE_TASK",d[d.REMOVE_CATEGORY=35]="REMOVE_CATEGORY",d[d.MOVE_TASK_WITHIN_ORIGIN=36]="MOVE_TASK_WITHIN_ORIGIN",d[d.MOVE_CATEGORY=37]="MOVE_CATEGORY",d[d.MOVE_TASK_TO_NON_EMPTY_CATEGORY=38]="MOVE_TASK_TO_NON_EMPTY_CATEGORY",d[d.SET_RESTORED_TASK=39]="SET_RESTORED_TASK",d[d.CLEAR_RESTORED_TASK=40]="CLEAR_RESTORED_TASK",d[d.CLEAR_RESTORED_LAB=41]="CLEAR_RESTORED_LAB",d[d.SET_TASK=42]="SET_TASK",d[d.UPDATE_TASK_ETAG=43]="UPDATE_TASK_ETAG",d[d.UPDATE_TASK_CONTENT=44]="UPDATE_TASK_CONTENT",d[d.ACTIVATE_DRAFT_LAB_STATUS=45]="ACTIVATE_DRAFT_LAB_STATUS",d[d.PENDING=46]="PENDING",d[d.FULFILLED=47]="FULFILLED",d[d.REJECTED=48]="REJECTED",d[d.UPDATE_E_TAG=49]="UPDATE_E_TAG",d[d.SET_DIRTY=50]="SET_DIRTY";var Q=function(a,b){var c=JSON.parse(a),d=Object.keys(c.toc||{}).length?c.toc:(0,v.qH)(q.j1J.CLOUD_LAB_CATEGORY);return N(M(N(M({},c),{toc:d}),c.lab_type===b.CLOUD_COURSE?{widget_groups:c.widget_groups||[{id:"".concat(c.author_id,"_").concat(c.collection_id),group_name:"DEFAULT"},]}:{}),{is_policy_valid:!!c.policy,content:(0,u.KN)(c.content)})},R={DRAFT:1e3,IN_ADMIN_REVIEW:1001,APPROVED:1002},S=function(a){return function(b){b(z.n.close()),b(z.n.show(r.zN,{onConfirm:a,cancelText:"Cancel",confirmText:"Save",title:"Conflicts",description:"The content you are editing has changed. The previous changes will be overwritten. Are you sure you want to save?"}))}},T="general-info",U="lab-config",V="lab-content",W="review-lab",X=[{id:T,title:"General Information",isCompleted:function(a){return a.title&&"Untitled Lab"!==a.title&&a.summary&&!!a.time_limit&&!!a.cloud_provider}},{id:U,title:"Lab Configuration",isCompleted:function(a){return a.is_policy_valid}},{id:V,title:"Lab Content",isCompleted:function(a){var b;return(null===(b=a.content)|| void 0===b?void 0:b.length)>0}},{id:W,title:"Review Lab",isCompleted:function(a){return a.lab_status===R.APPROVED}},],Y=function(a,b){return(0,n.Z)({url:"/api/editorial/".concat(a.author_id,"/").concat(a.collection_id,"/").concat(a.cloud_lab_id,"/price"),type:"PUT",contentType:"application/json",processData:!1,data:JSON.stringify({credit_cost:b})})},Z=function(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]&&arguments[3],e=arguments.length>4&& void 0!==arguments[4]?arguments[4]:null,f=arguments.length>5&& void 0!==arguments[5]?arguments[5]:null;return(0,n.Z)({url:"/api/editorial/cloud-lab/".concat(a,"/").concat(b,"/").concat(c,"/test-lab?published=").concat(d).concat(e&&f?"&active_group_id="+e+"&active_page_id="+f:""),type:"GET"})},$=function(a,b,c,d){var e=a.author_id,f=a.collection_id,g=a.cloud_lab_id;return(0,n.Z)({url:"/api/author/".concat(e,"/collection/").concat(f,"/cloud-lab/").concat(g,"?submit=").concat(d),contentType:"application/json",processData:!1,type:"PUT",data:JSON.stringify(c),headers:L({},s.Zq,b)},!0)},_=function(a,b,c){return(0,n.Z)({url:"/api/editorial/cloud-lab/".concat(a,"/").concat(b,"/").concat(c,"/test-lab"),type:"POST"})},aa=function(a,b,c,d){return(0,n.Z)({url:"/api/editorial/cloud-lab/".concat(a,"/").concat(b,"/").concat(c,"/test-lab"),type:"PUT",data:{policy:d}})},ab=function(a,b,c){var d=arguments.length>3&& void 0!==arguments[3]&&arguments[3];return(0,n.Z)({url:"/api/editorial/cloud-lab/".concat(a,"/").concat(b,"/").concat(c,"/console?published=").concat(d),type:"GET"})},ac=function(a,b,c){return(0,n.Z)({url:"/api/cloud-lab/".concat(a,"/").concat(b,"/validate-policy"),type:"POST",data:{policy:c}})},ad=function(a){var b=a.author_id,c=a.collection_id,d=a.cloud_lab_id;return(0,n.Z)({url:"/api/cloud-lab/".concat(b,"/").concat(c,"/").concat(d,"/lab-setup"),type:"POST"})},ae=function(a,b,c,d){return(0,w.XC)({apiPromise:function(){return(0,n.Z)({url:"/api/cloud-lab/".concat(a,"/").concat(b,"/").concat(c,"/lab-setup"),type:"GET"})},cb:function(a){if(a.status!==q.Psf.IN_PROGRESS)return d(a.status),!0},error:function(){d(q.Psf.FAILED)},intervalTimeMS:15e3,maxRetries:40})},af=function(a,b){var c;return c=K(g().mark(function c(d){var e,f,h,i;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return f=(e=JSON.parse(b)).upload_url,h=e.image_id,a=N(M({},a),{content:N(M({},a.content),{image_id:h})}),c.next=5,fetch(a.content.file).then(function(a){return a.blob()});case 5:return i=c.sent,URL.revokeObjectURL(a.content.file),c.next=9,(0,l.iL)({upload_url:f,file:i});case 9:delete a.content.file,d(B.o.updateContentState(a.hash,{image_id:a.content.image_id,file:null}));case 11:case"end":return c.stop()}},c)})),function(a){return c.apply(this,arguments)}},ag=function(a,b,c,d){var e;return e=K(g().mark(function e(f){return g().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=K(g().mark(function e(h,i){var j;return g().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,l.p9)({authorId:a,collectionId:b,cloudLabId:c});case 3:return j=e.sent,e.next=6,f(af(d,j));case 6:h(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),i(e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(a,b){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)})),function(a){return e.apply(this,arguments)}},ah=function(a,b,c,d){return(0,n.Z)({url:"/api/cloud-lab/".concat(a,"/").concat(b,"/").concat(c,"/user-feedback"),type:"POST",data:d})},ai=function(a,b,c,d,e){if(new Set(a.relevant_courses).size!==a.relevant_courses.length)throw Error("A duplicate relevant course can not be added");a.relevant_courses.forEach(function(a,b){if(!o.gX.test(a))throw Error("Relevant course ".concat(b+1," has incorrect course link"))});var f,g,h,i=b||a.content||[],j=c||a.landing_page_content,k=(0,D.Dn)(b?i:(null===(f=i.ids)|| void 0===f?void 0:f.map(function(a){return i.entities[a]}))||[]),l=JSON.stringify(a.toc),m=2===a.version;return N(M({},a),{docker:JSON.stringify((0,E.qZ)(d)),testing_docker:JSON.stringify((0,E.qZ)(e)),udata_files:JSON.stringify(null!==(h=null===(g=a.udata_files)|| void 0===g?void 0:g.map(function(a){return a.file_id}))&& void 0!==h?h:[]),content:m?[]:i,concept_list:k,toc:m?l:JSON.stringify({}),landing_page_content:j,relevant_courses:JSON.stringify(a.relevant_courses.filter(function(a){return a})),widget_groups:a.widget_groups&&JSON.stringify(a.widget_groups)})},aj=function(a,b){var d=arguments.length>2&& void 0!==arguments[2]&&arguments[2],e=!(arguments.length>3)|| void 0===arguments[3]||arguments[3];return function(a,f){var g=c.g.cloudLabActions;return b&&(e?a(b):b()),a(z.n.show(r.ad,{status:"WAIT",text:"Saving Cloud Lab"})),g.save(!1,null,null,d).then(function(){a(z.n.show(r.ad,{status:"SUCCESS",text:"Cloud Lab saved"}))}).catch(function(c){(0,G.rU)(c,a,void 0,[p.Wy.notFoundException]);var d,f=null==c?void 0:null===(d=c.responseJSON)|| void 0===d?void 0:d.errorText;c.status===p.Wy.AlreadyExistsException&&f===p.pX.versionOutDatedMessage?a(S(function(){g.updateETag(q.FhE),aj(void 0,b,!1,e)})):a(z.n.show(r.ad,{status:"ERROR",text:"Failed to save cloud lab"}))})}},ak=function(a,b,c,d,e){return function(f){var g=d.file.name.split(" ").join("-"),h="/api/author/".concat(a,"/collection/").concat(b,"/containers/").concat(g,"/get_upload_url?cloudlab_id=").concat(c,"&docker_type=").concat(e.toLowerCase());return(0,n.Z)({url:h,type:"GET"}).then(JSON.parse).then(function(a){var b=a.gcs_object_name,c=a.container_id,h=a.blob_upload_url,i=a.upload_success_url,j=a.build_status_url,k=a.tarball_download_url,l=a.build_log_url,m=a.rebuild_image_url,o=e===t.a5.TESTING?y.h:x.ry;return f(o.setFile(N(M({},d),{id:void 0===c?-1:c,buildStatusUrl:j,tarballDownloadUrl:k,buildLogUrl:l,rebuildImageUrl:m,file:{name:g,size:d.file.size,awaitingUpload:!0}}))),{onUploadSuccess:function(){return(0,n.Z)({url:i,type:"POST",data:{gcs_object_name:b}},!0)},upload:function(){return(0,n.Z)({url:h,type:"POST",data:d.file,processData:!1,contentType:d.file.type})}}}).catch(function(a){console.log(a)})}},al={loaded:!1,cloud_lab_task_id:null,selected_runner_id:"-1",content:null,envContent:{codeContent:{},type:""},"X-ETag":null,modified:null,author_id:null},am={loaded:!1,dirty:!1,task:al,active_draft_lab_status:!1},an=k.createContext(am),ao=k.createContext(null);function ap(a,b){switch(b.type){case e.PENDING:return N(M({},a),{loading:!0});case e.FULFILLED:return{error:void 0,loading:!1,loaded:!0,data:M({},a.data,b.payload)};case e.REJECTED:return{loading:!1,loaded:!1,error:null===(c=b.payload)|| void 0===c?void 0:c.error};case e.CLEAR:return M({},am);case e.CLEAR_TASK:var c,d,f,g=null!==(f=null===(d=a.task)|| void 0===d?void 0:d.envContent)&& void 0!==f?f:{codeContent:{},type:""};return N(M({},a),{task:N(M({},am.task),{envContent:g})});case e.ON_SAVE_SUCCESS:return N(M({},a),{data:N(M({},a.data),{"X-ETag":b.payload}),dirty:!1});case e.UPDATE_LAB_PRICE:return N(M({},a),{data:N(M({},a.data),{credit_cost:b.payload})});case e.UPDATE_TITLE:return N(M({},a),{data:N(M({},a.data),{title:b.payload}),dirty:!0});case e.UPDATE_TIME_LIMIT:return N(M({},a),{data:N(M({},a.data),{time_limit:b.payload}),dirty:!0});case e.UPDATE_CLOUD_LAB_WIDGET_COMPONENT:var h=b.payload,k=h.component,l=h.index,m=Array.isArray(a.data.content)?O(a.data.content):M({},a.data.content);return m[l]=k,N(M({},a),{data:N(M({},a.data),{content:m})});case e.UPDATE_CLOUD_LAB_TASK_WIDGET:var n=b.payload,o=n.component,p=n.index,r=Array.isArray(a.data.content)?O(a.data.content):M({},a.data.content);return m[p]=o,N(M({},a),{data:N(M({},a.data),{content:r})});case e.CLEAR_TASK_WIDGETS:if(!a.loaded||!(null===(t=a.task)|| void 0===t?void 0:t.content))return a;return N(M({},a),{task:N(M({},a.task),{content:[]})});case e.ADD_USER_DATA_RESOURCE_FILE:return N(M({},a),{data:N(M({},a.data),{udata_files:O(a.data.udata_files).concat([b.payload])}),dirty:!0});case e.REMOVE_USER_DATA_RESOURCE_FILE:return(0,j.Uy)(a,function(a){a.data.udata_files.splice(b.payload.index,1),a.dirty=!0});case e.UPDATE_USER_DATA_RESOURCE_FILE:return(0,j.Uy)(a,function(a){var c=b.payload.index;a.data.udata_files[c]=M({},a.data.udata_files[c],b.payload.payload),a.dirty=!0});case e.UPDATE_CLOUD_PROVIDER:return N(M({},a),{data:N(M({},a.data),{cloud_provider:b.payload}),dirty:!0});case e.UPDATE_SUMMARY:return N(M({},a),{data:N(M({},a.data),{summary:b.payload}),dirty:!0});case e.UPDATE_WIDGETS_GROUP:return N(M({},a),{data:N(M({},a.data),{widget_groups:b.payload}),dirty:!0});case e.UPDATE_LANDING_PAGE_CONTENT:return N(M({},a),{data:N(M({},a.data),{landing_page_content:b.payload.landing_page_content}),dirty:!0});case e.UPDATE_RELEVANT_COURSES:return N(M({},a),{data:N(M({},a.data),{relevant_courses:b.payload}),dirty:!0});case e.UPDATE_CONTENT:return N(M({},a),{data:N(M({},a.data),{content:b.payload.content}),dirty:b.payload.dirty});case e.UPDATE_TASK_CODE_CONTENT:return N(M({},a),{task:N(M({},a.task),{envContent:N(M({},a.task.envContent),{codeContent:b.payload.codeContent})}),dirty:!0});case e.UPDATE_CODING_ENV:return N(M({},a),{task:N(M({},a.task),{envContent:N(M({},a.task.envContent),{type:b.payload,codeContent:{selectedEnvVars:{},comp_id:(0,i.x0)()}})}),dirty:!0});case e.UPDATE_POLICY:return N(M({},a),{data:N(M({},a.data),{policy:b.payload.policy,is_policy_valid:!1}),dirty:!0});case e.UPDATE_SETUP_SCRIPT:return N(M({},a),{data:N(M({},a.data),{setup_script:b.payload.setup_script}),dirty:!0});case e.UPDATE_CLI_ENABLED:return N(M({},a),{data:N(M({},a.data),{is_cli_enabled:b.payload.is_cli_enabled}),dirty:!0});case e.TOGGLE_CODING_ENV:return N(M({},a),{data:N(M({},a.data),{enable_coding_env:b.payload.enable_coding_env}),dirty:!0});case e.UPDATE_LOGIN_CONSOLE:return N(M({},a),{data:N(M({},a.data),{disable_federated_login:b.payload.disable_federated_login}),dirty:!0});case e.UPDATE_CLI_DOCKER_JOB_KEY:return N(M({},a),{data:N(M({},a.data),{cli_docker_job_key:b.payload.cli_docker_job_key}),dirty:!0});case e.UPDATE_TASK_RUNNER:return N(M({},a),{task:N(M({},a.task),{selected_runner_id:b.payload.selected_runner_id}),dirty:!0});case e.UPDATE_STATUS:return N(M({},a),{data:N(M({},a.data),{lab_status:b.payload})});case e.UPDATE_IS_POLICY_VALID:return N(M({},a),{data:N(M({},a.data),{is_policy_valid:b.payload.is_policy_valid})});case e.UPDATE_DOCKER:if(null===(w=a.data)|| void 0===w?void 0:w.docker)return N(M({},a),{data:N(M({},a.data),{docker:b.payload})});return a;case e.ADD_CATEGORY:return(0,j.Uy)(a,function(a){var c,d,e=null==a?void 0:null===(c=a.data)|| void 0===c?void 0:null===(d=c.toc)|| void 0===d?void 0:d.categories;(0,v.oW)(e)?(a.data.toc.categories[0].title="Untitled category",a.data.toc.categories[0].editMode=!0):(0,v.SK)(a.data,!0,!1,b.payload.index,b.payload.parentIndex,q.j1J.CLOUD_LAB_CATEGORY),a.dirty=!0});case e.ADD_TASK:return(0,j.Uy)(a,function(a){var c,d,e,f=(0,v.QY)(null==a?void 0:null===(c=a.data)|| void 0===c?void 0:null===(d=c.toc)|| void 0===d?void 0:d.categories,b.payload.category_id);(0,v.WL)(a,null===(e=b.payload.task)|| void 0===e?void 0:e.cloud_lab_task_id,f,b.payload.index,q.qen.CLOUD_LAB_TASK,b.payload.title),a.dirty=!0});case e.UPDATE_CATEGORY_TITLE:var t,w,x,y,z=b.payload,A=z.title,B=z.id,C=(0,v.QY)(null==a?void 0:null===(x=a.data)|| void 0===x?void 0:null===(y=x.toc)|| void 0===y?void 0:y.categories,B),D=O(a.data.toc.categories);return D[C]=N(M({},D[C]),{title:"__default"!==A?A:"",editMode:!1}),N(M({},a),{data:N(M({},a.data),{toc:N(M({},a.data.toc),{categories:D})}),dirty:!0});case e.UPDATE_TASK_TITLE:if(!a.data||!b.payload.categoryId)return M({},a);var E=(0,v.QY)(a.data.toc.categories,b.payload.categoryId),F=(0,v.QY)(a.data.toc.categories[E].pages,b.payload.taskId),G=O(a.data.toc.categories);return G[E]=N(M({},G[E]),{pages:O(G[E].pages)}),G[E].pages[F]=N(M({},G[E].pages[F]),{title:b.payload.title,editMode:!1}),N(M({},a),{data:N(M({},a.data),{toc:N(M({},a.data.toc),{categories:G})}),dirty:!0});case e.REMOVE_TASK:var H,I,J,K,P,Q,R=b.payload,S=R.category_id,T=R.taskId,U=(0,v.QY)(null==a?void 0:null===(H=a.data)|| void 0===H?void 0:null===(I=H.toc)|| void 0===I?void 0:I.categories,S);if(-1===U)return M({},a);var V=(0,v.QY)(null==a?void 0:null===(J=a.data)|| void 0===J?void 0:null===(K=J.toc)|| void 0===K?void 0:null===(P=K.categories)|| void 0===P?void 0:null===(Q=P[U])|| void 0===Q?void 0:Q.pages,T),W=O(a.data.toc.categories[U].pages);-1!==V&&W.splice(V,1);var X=O(a.data.toc.categories);return X[U]=N(M({},X[U]),{pages:W}),N(M({},a),{data:N(M({},a.data),{toc:N(M({},a.data.toc),{categories:X})}),dirty:!0});case e.REMOVE_CATEGORY:var Y=b.payload.id;if(!a.data)return M({},a);var Z=(0,v.QY)(a.data.toc.categories,Y),$=O(a.data.toc.categories);if($.splice(Z,1),$.length)return N(M({},a),{data:N(M({},a.data),{toc:N(M({},a.data.toc),{categories:$})}),dirty:!0});return N(M({},a),{data:N(M({},a.data),{toc:(0,v.qH)(q.j1J.CLOUD_LAB_CATEGORY)}),dirty:!0});case e.MOVE_TASK_WITHIN_ORIGIN:return(0,j.Uy)(a,function(a){var c,d,e,f,g=null==a?void 0:null===(c=a.data)|| void 0===c?void 0:null===(d=c.toc)|| void 0===d?void 0:null===(e=d.categories)|| void 0===e?void 0:null===(f=e[b.payload.from.parentIndex])|| void 0===f?void 0:f.pages;g.splice(b.payload.to.itemIndex,0,g.splice(b.payload.from.itemIndex,1)[0]),a.dirty=!0});case e.MOVE_CATEGORY:return(0,j.Uy)(a,function(a){var c,d,e,f=null==a?void 0:null===(c=a.data)|| void 0===c?void 0:null===(d=c.toc)|| void 0===d?void 0:null===(e=d.categories)|| void 0===e?void 0:e[b.payload.from.itemIndex];a.data.toc.categories.splice(b.payload.from.itemIndex,1),a.data.toc.categories.splice(b.payload.to.itemIndex,0,f),a.dirty=!0});case e.MOVE_TASK_TO_NON_EMPTY_CATEGORY:return(0,j.Uy)(a,function(a){var c,d=null===(c=null==a?void 0:a.data.toc)|| void 0===c?void 0:c.categories;d[b.payload.to.parentIndex].pages.splice(b.payload.to.itemIndex,0,d[b.payload.from.parentIndex].pages.splice(b.payload.from.itemIndex,1)[0]),a.dirty=!0});case e.SET_RESTORED_TASK:return(0,j.Uy)(a,function(a){a.task&&(a.task=(0,u.Ny)({content:b.payload.data}),a.task.loaded=!0)});case e.CLEAR_RESTORED_TASK:return N(M({},a),{task:M({},(0,u.Ny)({}))});case e.CLEAR_RESTORED_LAB:return N(M({},a),{loaded:!1,loading:!0});case e.SET_TASK:return N(M({},a),{task:b.payload.data});case e.UPDATE_TASK_ETAG:return N(M({},a),{task:N(M({},a.task),L({},s.Zq,b.payload))});case e.UPDATE_TASK_CONTENT:return N(M({},a),{task:N(M({},a.task),{content:b.payload.content})});case e.SET_DIRTY:return N(M({},a),{dirty:b.payload});case e.ACTIVATE_DRAFT_LAB_STATUS:return N(M({},a),{data:N(M({},a.data),{active_draft_lab_status:b.payload.active_draft_lab_status})});case e.UPDATE_E_TAG:return N(M({},a),{data:N(M({},a.data),L({},s.Zq,b.payload))});default:return a}}var aq=function(a){var b,d,f,i,j=a.children,l=(0,A.TL)(),o=(b=k.useReducer(ap,am),d=2,function(a){if(Array.isArray(a))return a}(b)||function(a,b){var c,d,e=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=e){var f=[],g=!0,h=!1;try{for(e=e.call(a);!(g=(c=e.next()).done)&&(f.push(c.value),!b||f.length!==b);g=!0);}catch(i){h=!0,d=i}finally{try{g||null==e.return||e.return()}finally{if(h)throw d}}return f}}(b,d)||P(b,d)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=o[0],w=o[1],D=(0,A.ix)(function(a){return a.dockerDetails}),I=(0,A.ix)(function(a){return a.testingDockerDetails}),J=(0,A.ix)(function(a){return a.widgets}),O={clear:function(){w({type:e.CLEAR})},clearTask:function(){w({type:e.CLEAR_TASK})},onSaveSuccess:function(a){w({type:e.ON_SAVE_SUCCESS,payload:a})},updateLabPrice:function(a){w({type:e.UPDATE_LAB_PRICE,payload:a})},updateTitle:function(a){w({type:e.UPDATE_TITLE,payload:a})},updateTimeLimit:function(a){w({type:e.UPDATE_TIME_LIMIT,payload:a})},updateCloudLabWidgetComponent:function(a){w({type:e.UPDATE_CLOUD_LAB_WIDGET_COMPONENT,payload:a})},updateCloudLabTaskWidget:function(a){w({type:e.UPDATE_CLOUD_LAB_TASK_WIDGET,payload:a})},clearTaskWidgets:function(){w({type:e.CLEAR_TASK_WIDGETS})},addUserDataResourceFile:function(a){w({type:e.ADD_USER_DATA_RESOURCE_FILE,payload:a})},updateUserDataResourceFile:function(a){w({type:e.UPDATE_USER_DATA_RESOURCE_FILE,payload:a})},removeUserDataResourceFile:function(a){w({type:e.REMOVE_USER_DATA_RESOURCE_FILE,payload:a})},updateCloudProvider:function(a){w({type:e.UPDATE_CLOUD_PROVIDER,payload:a})},updateSummary:function(a){w({type:e.UPDATE_SUMMARY,payload:a})},updateWidgetGroups:function(a){w({type:e.UPDATE_WIDGETS_GROUP,payload:a})},updateLandingPageContent:function(a){w({type:e.UPDATE_LANDING_PAGE_CONTENT,payload:a})},updateRelevantCourses:function(a){w({type:e.UPDATE_RELEVANT_COURSES,payload:a})},updateContent:function(a){w({type:e.UPDATE_CONTENT,payload:a})},updateTaskCodeContent:function(a){w({type:e.UPDATE_TASK_CODE_CONTENT,payload:a})},updateCodingEnv:function(a){w({type:e.UPDATE_CODING_ENV,payload:a})},updatePolicy:function(a){w({type:e.UPDATE_POLICY,payload:a})},updateSetupScript:function(a){w({type:e.UPDATE_SETUP_SCRIPT,payload:a})},updateCLIEnabled:function(a){w({type:e.UPDATE_CLI_ENABLED,payload:a})},toggleCodingEnv:function(a){w({type:e.TOGGLE_CODING_ENV,payload:a})},updateLoginConsole:function(a){w({type:e.UPDATE_LOGIN_CONSOLE,payload:a})},updateCliDockerJobKey:function(a){w({type:e.UPDATE_CLI_DOCKER_JOB_KEY,payload:a})},updateTaskRunner:function(a){w({type:e.UPDATE_TASK_RUNNER,payload:a})},updateStatus:function(a){w({type:e.UPDATE_STATUS,payload:a})},updateIsPolicyValid:function(a){w({type:e.UPDATE_IS_POLICY_VALID,payload:a})},updateDocker:function(a){w({type:e.UPDATE_DOCKER,payload:a})},addCategory:function(a){w({type:e.ADD_CATEGORY,payload:a})},addTask:function(a){var b=a.category_id,c=a.task,d=a.index,f=a.title;w({type:e.ADD_TASK,payload:{category_id:b,task:c,index:d,title:void 0===f?"":f}})},updateCategoryTitle:function(a){w({type:e.UPDATE_CATEGORY_TITLE,payload:a})},updateTaskTitle:function(a){w({type:e.UPDATE_TASK_TITLE,payload:a})},removeTask:function(a){w({type:e.REMOVE_TASK,payload:a})},removeCategory:function(a){w({type:e.REMOVE_CATEGORY,payload:a})},moveTaskWithinOrigin:function(a){w({type:e.MOVE_TASK_WITHIN_ORIGIN,payload:a})},moveCategory:function(a){w({type:e.MOVE_CATEGORY,payload:a})},moveTaskToNotEmptyCategory:function(a){w({type:e.MOVE_TASK_TO_NON_EMPTY_CATEGORY,payload:a})},setRestoredTask:function(a){w({type:e.SET_RESTORED_TASK,payload:a})},clearRestoredTask:function(){w({type:e.CLEAR_RESTORED_TASK})},clearRestoredLab:function(){w({type:e.CLEAR_RESTORED_LAB})},setTask:function(a){w({type:e.SET_TASK,payload:a})},updateTaskEtag:function(a){w({type:e.UPDATE_TASK_ETAG,payload:a})},updateETag:function(a){w({type:e.UPDATE_E_TAG,payload:a})},updateTaskContent:function(a){w({type:e.UPDATE_TASK_CONTENT,payload:a})},setDirty:function(a){w({type:e.SET_DIRTY,payload:a})},activateDraftLabStatus:function(a){w({type:e.ACTIVATE_DRAFT_LAB_STATUS,payload:a})},pending:function(){w({type:e.PENDING})},fulfilled:function(a){w({type:e.FULFILLED,payload:a})},rejected:function(a){w({type:e.REJECTED,payload:{error:a}})},load:(f=K(g().mark(function a(b){var d,e,f,h,i,j,k,l,m,o,q,r,t,u,w,x;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.authorId,e=b.collectionId,f=b.cloudLabId,h=b.course_url_slug,i=void 0===h?"":h,j=b.page_url_slug,k=void 0===j?"":j,l=b.mode,m=b.published,o=void 0!==m&&m,q=b.isLockedPreview,r=void 0!==q&&q,t=i&&k?"cloud-lab/".concat(i,"/").concat(k):"cloud-lab/".concat(d,"/").concat(e,"/").concat(f),w=(u="view"===l)?t:"author/".concat(d,"/collection/").concat(e,"/cloud-lab/").concat(f),x=M({},r?{is_locked_preview:r}:{},o?{published:o}:{}),O.clear(),O.pending(),a.abrupt("return",(0,n.Z)({url:"/api/".concat(w).concat((0,C.N)(x)),type:"GET"},!0).then(function(){var a=K(g().mark(function a(b){var d,e,f,h;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.data,e=b.xhr,a.next=3,Promise.resolve().then(c.bind(c,34290));case 3:f=a.sent.CloudLabType,h=(null==v?void 0:v.task)||al,O.fulfilled(Q(d,f)),O.setTask({data:h}),d&&!u&&O.onSaveSuccess(e.headers.get(s.Zq));case 8:case"end":return a.stop()}},a)}));return function(b){return a.apply(this,arguments)}}()).catch(function(a){a.status===p.Wy.unauthorizedException?(0,G.xc)():a.status===p.Wy.notFoundException&&(0,c.g.setNotFound)({notFoundPageStatus:!0}),O.rejected((0,G.nU)(a))}));case 8:case"end":return a.stop()}},a)})),function(a){return f.apply(this,arguments)}),loadLabSnapshot:function(a,b,d){var e;(0,m.v)(a,b,d,q.qen.CLOUD_LAB).then((e=K(g().mark(function a(b){var d;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(null==b?void 0:b.data)){a.next=6;break}return a.next=3,Promise.resolve().then(c.bind(c,34290));case 3:return d=a.sent.CloudLabType,O.fulfilled(Q(null==b?void 0:b.data,d)),a.abrupt("return",null==b?void 0:b.data);case 6:case"end":return a.stop()}},a)})),function(a){return e.apply(this,arguments)}))},loadTaskSnapshot:function(a,b,c){(0,m.v)(a,b,c,q.qen.CLOUD_LAB_TASK).then(function(a){if(null==a?void 0:a.data){var b=JSON.parse(a.data);return O.setRestoredTask({data:b}),b}})},loadTask:function(a){var b=a.authorId,d=a.collectionId,e=a.cloudLabId,f=a.cloudLabTaskId,g=arguments.length>1&& void 0!==arguments[1]&&arguments[1];arguments.length>2&& void 0!==arguments[2]&&arguments[2];var h=g?"/api/cloud-lab/".concat(b,"/").concat(d,"/").concat(e,"/").concat(f):"/api/author/".concat(b,"/collection/").concat(d,"/cloud-lab/").concat(e,"/cloud-lab-task/").concat(f);(0,n.Z)({url:h,type:"GET"},!0).then(function(a){if(null==a?void 0:a.data){var b=JSON.parse(null==a?void 0:a.data)||{},c=(0,u.Ny)(b),d=(0,u.KN)(c.content);O.setTask({data:N(M({},c),{loaded:!0,content:d})}),g||O.updateTaskEtag(a.xhr.headers.get(s.Zq))}}).catch(function(a){a.status===p.Wy.unauthorizedException?(0,G.xc)():a.status===p.Wy.notFoundException&&(O.setTask({data:N(M({},al),{loaded:!0})}),!g)&&(0,c.g.setNotFound)({notFoundPageStatus:!0})})},save:K(g().mark(function a(){var b,d,e,f,h,i,j,k,m,n=arguments;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b=n.length>0&& void 0!==n[0]&&n[0],d=n.length>1&& void 0!==n[1]?n[1]:null,e=n.length>2&& void 0!==n[2]?n[2]:null,f=n.length>3&& void 0!==n[3]&&n[3],h=v.data,l(z.n.show(r.ad,{status:"WAIT",text:"".concat(b?"Submitting":"Saving"," Cloud Lab")})),a.prev=3,j=(i=ai(h,d,e,D,I)).landing_page_content,k=i.content,a.abrupt("return",$(M({},h),h[s.Zq],i,b).then(function(){var a=K(g().mark(function a(f){var i;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return f&&O.onSaveSuccess(f.xhr.headers.get(s.Zq)),!h.is_admin&&h.active_draft_lab_status&&O.updateStatus(R.DRAFT),b&&O.updateStatus(R.IN_ADMIN_REVIEW),a.next=5,Promise.resolve().then(c.bind(c,34290));case 5:i=a.sent.CloudLabType,h.lab_type!==i.CLOUD_COURSE&&O.updateLandingPageContent({landing_page_content:j}),l(z.n.show(r.ad,{status:"SUCCESS",text:"Cloud Lab ".concat(b?"Submitted":"Saved")})),O.activateDraftLabStatus({active_draft_lab_status:!1}),(d||e)&&(O.updateContent({content:k,dirty:!1}),l(B.o.resetDirtyBit()),l(B.o.resetMarkdownDirtyBit()),l(B.o.load(d?k:j,!0)));case 10:case"end":return a.stop()}},a)}));return function(b){return a.apply(this,arguments)}}()).catch(function(a){(0,G.rU)(a,l,void 0,[p.Wy.notFoundException,]);var b,c=null==a?void 0:null===(b=a.responseJSON)|| void 0===b?void 0:b.errorText;a.status===p.Wy.AlreadyExistsException&&c===p.pX.versionOutDatedMessage?l(S(function(){O.updateETag(q.FhE),O.save(!1,d,e)})):l(z.n.show(r.ad,{status:"ERROR",text:(0,H.ie)(a)||c||"Failed to save Cloud Lab"}))}));case 9:if(a.prev=9,a.t0=a.catch(3),m=a.t0.message||"Failed to save cloud lab!",l(z.n.show(r.ad,{status:"ERROR",text:m})),!f){a.next=15;break}throw Error(m);case 15:case"end":return a.stop()}},a,null,[[3,9]])})),saveTask:K(g().mark(function a(){var b,c,d,e,f,h=arguments;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b=h.length>0&& void 0!==h[0]?h[0]:null,l(z.n.show(r.ad,{status:"WAIT",text:"Saving Task"})),d=(null==(c=v.task)?void 0:c.envContent)||{},e=b||(null==c?void 0:c.content)||{content:[],envContent:d},e=(0,u.an)(e,null==c?void 0:c.cloud_lab_id),e=b?{content:e,envContent:d}:e,f=N(M({},c),{content:e}),a.abrupt("return",(0,n.Z)({url:"/api/author/".concat(f.author_id,"/collection/").concat(f.collection_id,"/cloud-lab/").concat(f.cloud_lab_id,"/cloud-lab-task/").concat(f.cloud_lab_task_id),contentType:"application/json",processData:!1,type:"PUT",data:JSON.stringify(f),headers:L({},s.Zq,f[s.Zq])},!0).then(function(a){a&&O.updateTaskEtag(a.xhr.headers.get(s.Zq)),l(z.n.show(r.ad,{status:"SUCCESS",text:"Task Saved"})),b&&(O.updateTaskContent({content:e}),O.updateTaskCodeContent(d),l(B.o.resetDirtyBit()),l(B.o.resetMarkdownDirtyBit()),l(B.o.load(e,!0)),O.setDirty(!1))}).catch(function(a){(0,G.rU)(a,l,void 0,[p.Wy.notFoundException,]);var c,d=null==a?void 0:null===(c=a.responseJSON)|| void 0===c?void 0:c.errorText;a.status===p.Wy.AlreadyExistsException&&d===p.pX.versionOutDatedMessage?l(S(function(){O.updateTaskEtag(q.FhE),O.saveTask(b)})):l(z.n.show(r.ad,{status:"ERROR",text:(0,H.ie)(a)||d||"Failed to save Task"}))}));case 9:case"end":return a.stop()}},a)})),updateLabStatus:function(a){l(z.n.show(r.ad,{status:"WAIT",text:"Updating Lab status"}));var b=N(M({},v.data),{new_lab_status:a,page_status:q.zaQ.DRAFT_INSTANCE});return(0,n.Z)({url:"/api/editorial/cloud-lab/approval",contentType:"application/json",processData:!1,data:JSON.stringify(b),type:"PUT"}).then(function(){O.updateStatus(a),l(z.n.show(r.ad,{status:"SUCCESS",text:"Lab status updated"}))}).catch(function(a){var b;(0,G.rU)(a,l,void 0,[p.Wy.notFoundException,]),l(z.n.show(r.ad,{status:"ERROR",text:(null==a?void 0:null===(b=a.responseJSON)|| void 0===b?void 0:b.errorText)||"Failed to update Lab"}))})},prepareDockerOnSetCloudLab:(i=K(g().mark(function a(b){var c,d,e,f,h,i;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=(null==b?void 0:b.docker)?N(M({},b.docker),{envs:null!==(c=b.docker.envs)&& void 0!==c?c:[]}):E.s4,a.next=4,(0,F.wi)(b.collection_id,b.author_id);case 4:e=a.sent,f=N(M({},d),{container:N(M({},d.container),{liveInstance:e})}),l(x.ry.setObject(f)),b.docker&&O.updateDocker(f),i=(null==b?void 0:b.testing_docker)?N(M({},b.testing_docker),{envs:null!==(h=b.testing_docker.envs)&& void 0!==h?h:[]}):E.s4,l(y.h.setObject(i));case 11:case"end":return a.stop()}},a)})),function(a){return i.apply(this,arguments)}),updateWidgetsContent:function(a){(J.dirty||J.markdownDirty)&&O.updateContent({content:J,dirty:a})},uploadCloudLabDockerFile:function(a){var b,c=a.upload,d=a.onUploadSuccess,e=a.dockerType,f=e===t.a5.TESTING?y.h:x.ry;return l(f.updateBuildStatus("UPLOADING")),c().then(function(){return d()}).then(function(a){return JSON.parse(a.data)}).then((b=K(g().mark(function a(b){var c,d;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=void 0===(c=b.image_name)?"default_name":c,l(f.afterFileUpload(d)),a.next=4,O.save();case 4:l(z.n.show(r.ad,{status:"SUCCESS",text:"Docker Image build has been queued!!"}));case 5:case"end":return a.stop()}},a)})),function(a){return b.apply(this,arguments)})).catch(function(a){if(500===a.status){O.uploadCloudLabDockerFile({upload:c,onUploadSuccess:d,dockerType:e});return}l(f.updateBuildStatus("FAILURE")),l(z.n.show(r.ad,{status:"ERROR",text:"Uploading Docker File failed"}))})}};return k.useEffect(function(){return c.g.cloudLab=v,function(){delete c.g.cloudLab}},[v]),k.useEffect(function(){c.g.cloudLabActions=M({},O)}),(0,h.jsx)(an.Provider,{value:v,children:(0,h.jsx)(ao.Provider,{value:M({},O),children:j})})};b.ZP=aq;var ar=function(){return k.useContext(an)},as=function(){return k.useContext(ao)}},3519:function(a,b,c){var d,e,f,g=c(83249);function h(){return(h=Object.assign?Object.assign.bind():function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a}).apply(this,arguments)}var i=function(a){return g.createElement("svg",h({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-alert-octagon"},a),d||(d=g.createElement("polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"})),e||(e=g.createElement("line",{x1:12,y1:8,x2:12,y2:12})),f||(f=g.createElement("line",{x1:12,y1:16,x2:12.01,y2:16})))};b.Z=i},40028:function(a,b,c){var d,e=c(83249);function f(){return(f=Object.assign?Object.assign.bind():function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a}).apply(this,arguments)}var g=function(a){return e.createElement("svg",f({width:20,height:20,viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},a),d||(d=e.createElement("path",{d:"M4 13a3 3 0 0 0-2.1.9C.7 15 0 20 0 20s5-.7 6.1-1.9A3 3 0 0 0 4 13Zm.7 3.7c-.3.3-2.2.8-2.2.8s.5-2 .8-2.2c.2-.2.4-.3.7-.3a1 1 0 0 1 .7 1.7Zm10.7-5C21.8 5.2 19.7.2 19.7.2s-5-2-11.3 4.3L5.8 4a2 2 0 0 0-1.9.5l-4 4 5 2.2L9.2 15l2.1 5 4-4A2 2 0 0 0 16 14l-.5-2.5Zm-10-2.9L3.5 8l2-2 1.4.3-1.5 2.5Zm6.6 7.7-.8-2c.8-.3 1.6-.8 2.5-1.4l.3 1.4-2 2Zm2-6.3a17.2 17.2 0 0 1-4 2.8l-3-3a17 17 0 0 1 2.8-4C14.4 1.3 18 2 18 2s.7 3.6-4 8.2ZM13 9a2 2 0 0 0 2-2 2 2 0 0 0-2-2 2 2 0 0 0-2 2c0 1.1.9 2 2 2Z"})))};b.Z=g}}])
//# sourceMappingURL=https://js.educative.io/static/_next/sourcemaps/static/chunks/34290-ea33086173b70ad6.js.map